<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>CatalpaFlat&#39;s Blogs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="IT technology has no end.">
<meta property="og:type" content="website">
<meta property="og:title" content="CatalpaFlat&#39;s Blogs">
<meta property="og:url" content="https://catalpaflat.cn/index.html">
<meta property="og:site_name" content="CatalpaFlat&#39;s Blogs">
<meta property="og:description" content="IT technology has no end.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CatalpaFlat&#39;s Blogs">
<meta name="twitter:description" content="IT technology has no end.">
    

    
        <link rel="alternate" href="/" title="CatalpaFlat&#39;s Blogs" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">CatalpaFlat&#39;s Blogs</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.jpeg" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Cari" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Tulis Sesuatu.." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Pos',
            PAGES: 'Halaman',
            CATEGORIES: 'Kategori',
            TAGS: 'Tag',
            UNTITLED: 'Tanpa Judul',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Cari" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.jpeg" />
            <h2 id="name">CatalpaFlat</h2>
            <h3 id="title">A good DEMO is a good brick wall.</h3>
            <span id="location"><i class="fa fa-map-marker"></i>ShenZhen, China</span>
            <a id="follow" target="_blank" href="https://github.com/CatalpaFlat">IKUTI</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                30
                <span>pos</span>
            </div>
            <div class="article-info-block">
                10
                <span>tag</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/CatalpaFlat" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-docker/命令/run" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/02/05/docker/命令/run/">Docker run 命令</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/02/05/docker/命令/run/">
            <time datetime="2018-02-05T14:33:12.000Z" itemprop="datePublished">2018-02-05</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/docker/">docker</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/docker/">docker</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="Docker-run-命令"><a href="#Docker-run-命令" class="headerlink" title="Docker run 命令"></a>Docker run 命令</h1><blockquote>
<p>docker run ：创建一个新的容器并运行一个命令</p>
</blockquote>
<h2 id="1-语法"><a href="#1-语法" class="headerlink" title="1. 语法"></a>1. 语法</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure>
<h3 id="1-1-OPTIONS说明"><a href="#1-1-OPTIONS说明" class="headerlink" title="1.1. OPTIONS说明"></a>1.1. OPTIONS说明</h3><ol>
<li>-a stdin: 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项；</li>
<li>-d: 后台运行容器，并返回容器ID；</li>
<li>-i: 以交互模式运行容器，通常与 -t 同时使用；</li>
<li>-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</li>
<li>–name=”nginx-lb”: 为容器指定一个名称；</li>
<li>–dns 8.8.8.8: 指定容器使用的DNS服务器，默认和宿主一致；</li>
<li>–dns-search example.com: 指定容器DNS搜索域名，默认和宿主一致；</li>
<li>-h “mars”: 指定容器的hostname；</li>
<li>-e username=”ritchie”: 设置环境变量；</li>
<li>–env-file=[]: 从指定文件读入环境变量；</li>
<li>–cpuset=”0-2” or –cpuset=”0,1,2”: 绑定容器到指定CPU运行；</li>
<li>-m :设置容器使用内存最大值；</li>
<li>–net=”bridge”: 指定容器的网络连接类型，支持 bridge/host/none/container: 四种类型；</li>
<li>–link=[]: 添加链接到另一个容器；</li>
<li>–expose=[]: 开放一个端口或一组端口；<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">Run a command in a new container</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --add-host value              Add a custom host-to-IP mapping (host:ip) (default [])</span><br><span class="line">  -a, --attach value                Attach to STDIN, STDOUT or STDERR (default [])</span><br><span class="line">      --blkio-weight value          Block IO (relative weight), between 10 and 1000</span><br><span class="line">      --blkio-weight-device value   Block IO weight (relative device weight) (default [])</span><br><span class="line">      --cap-add value               Add Linux capabilities (default [])</span><br><span class="line">      --cap-drop value              Drop Linux capabilities (default [])</span><br><span class="line">      --cgroup-parent string        Optional parent cgroup for the container</span><br><span class="line">      --cidfile string              Write the container ID to the file</span><br><span class="line">      --cpu-percent int             CPU percent (Windows only)</span><br><span class="line">      --cpu-period int              Limit CPU CFS (Completely Fair Scheduler) period</span><br><span class="line">      --cpu-quota int               Limit CPU CFS (Completely Fair Scheduler) quota</span><br><span class="line">  -c, --cpu-shares int              CPU shares (relative weight)</span><br><span class="line">      --cpuset-cpus string          CPUs in which to allow execution (0-3, 0,1)</span><br><span class="line">      --cpuset-mems string          MEMs in which to allow execution (0-3, 0,1)</span><br><span class="line">  -d, --detach                      Run container in background and print container ID</span><br><span class="line">      --detach-keys string          Override the key sequence for detaching a container</span><br><span class="line">      --device value                Add a host device to the container (default [])</span><br><span class="line">      --device-read-bps value       Limit read rate (bytes per second) from a device (default [])</span><br><span class="line">      --device-read-iops value      Limit read rate (IO per second) from a device (default [])</span><br><span class="line">      --device-write-bps value      Limit write rate (bytes per second) to a device (default [])</span><br><span class="line">      --device-write-iops value     Limit write rate (IO per second) to a device (default [])</span><br><span class="line">      --disable-content-trust       Skip image verification (default true)</span><br><span class="line">      --dns value                   Set custom DNS servers (default [])</span><br><span class="line">      --dns-opt value               Set DNS options (default [])</span><br><span class="line">      --dns-search value            Set custom DNS search domains (default [])</span><br><span class="line">      --entrypoint string           Overwrite the default ENTRYPOINT of the image</span><br><span class="line">  -e, --env value                   Set environment variables (default [])</span><br><span class="line">      --env-file value              Read in a file of environment variables (default [])</span><br><span class="line">      --expose value                Expose a port or a range of ports (default [])</span><br><span class="line">      --group-add value             Add additional groups to join (default [])</span><br><span class="line">      --health-cmd string           Command to run to check health</span><br><span class="line">      --health-interval duration    Time between running the check (default 0s)</span><br><span class="line">      --health-retries int          Consecutive failures needed to report unhealthy</span><br><span class="line">      --health-timeout duration     Maximum time to allow one check to run (default 0s)</span><br><span class="line">      --help                        Print usage</span><br><span class="line">  -h, --hostname string             Container host name</span><br><span class="line">  -i, --interactive                 Keep STDIN open even if not attached</span><br><span class="line">      --io-maxbandwidth string      Maximum IO bandwidth limit for the system drive (Windows only)</span><br><span class="line">      --io-maxiops uint             Maximum IOps limit for the system drive (Windows only)</span><br><span class="line">      --ip string                   Container IPv4 address (e.g. 172.30.100.104)</span><br><span class="line">      --ip6 string                  Container IPv6 address (e.g. 2001:db8::33)</span><br><span class="line">      --ipc string                  IPC namespace to use</span><br><span class="line">      --isolation string            Container isolation technology</span><br><span class="line">      --kernel-memory string        Kernel memory limit</span><br><span class="line">  -l, --label value                 Set meta data on a container (default [])</span><br><span class="line">      --label-file value            Read in a line delimited file of labels (default [])</span><br><span class="line">      --link value                  Add link to another container (default [])</span><br><span class="line">      --link-local-ip value         Container IPv4/IPv6 link-local addresses (default [])</span><br><span class="line">      --log-driver string           Logging driver for the container</span><br><span class="line">      --log-opt value               Log driver options (default [])</span><br><span class="line">      --mac-address string          Container MAC address (e.g. 92:d0:c6:0a:29:33)</span><br><span class="line">  -m, --memory string               Memory limit</span><br><span class="line">      --memory-reservation string   Memory soft limit</span><br><span class="line">      --memory-swap string          Swap limit equal to memory plus swap: '-1' to enable unlimited swap</span><br><span class="line">      --memory-swappiness int       Tune container memory swappiness (0 to 100) (default -1)</span><br><span class="line">      --name string                 Assign a name to the container</span><br><span class="line">      --network string              Connect a container to a network (default "default")</span><br><span class="line">      --network-alias value         Add network-scoped alias for the container (default [])</span><br><span class="line">      --no-healthcheck              Disable any container-specified HEALTHCHECK</span><br><span class="line">      --oom-kill-disable            Disable OOM Killer</span><br><span class="line">      --oom-score-adj int           Tune host's OOM preferences (-1000 to 1000)</span><br><span class="line">      --pid string                  PID namespace to use</span><br><span class="line">      --pids-limit int              Tune container pids limit (set -1 for unlimited)</span><br><span class="line">      --privileged                  Give extended privileges to this container</span><br><span class="line">  -p, --publish value               Publish a container's port(s) to the host (default [])</span><br><span class="line">  -P, --publish-all                 Publish all exposed ports to random ports</span><br><span class="line">      --read-only                   Mount the container's root filesystem as read only</span><br><span class="line">      --restart string              Restart policy to apply when a container exits (default "no")</span><br><span class="line">      --rm                          Automatically remove the container when it exits</span><br><span class="line">      --runtime string              Runtime to use for this container</span><br><span class="line">      --security-opt value          Security Options (default [])</span><br><span class="line">      --shm-size string             Size of /dev/shm, default value is 64MB</span><br><span class="line">      --sig-proxy                   Proxy received signals to the process (default true)</span><br><span class="line">      --stop-signal string          Signal to stop a container, SIGTERM by default (default "SIGTERM")</span><br><span class="line">      --storage-opt value           Storage driver options for the container (default [])</span><br><span class="line">      --sysctl value                Sysctl options (default map[])</span><br><span class="line">      --tmpfs value                 Mount a tmpfs directory (default [])</span><br><span class="line">  -t, --tty                         Allocate a pseudo-TTY</span><br><span class="line">      --ulimit value                Ulimit options (default [])</span><br><span class="line">  -u, --user string                 Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br><span class="line">      --userns string               User namespace to use</span><br><span class="line">      --uts string                  UTS namespace to use</span><br><span class="line">  -v, --volume value                Bind mount a volume (default [])</span><br><span class="line">      --volume-driver string        Optional volume driver for the container</span><br><span class="line">      --volumes-from value          Mount volumes from the specified container(s) (default [])</span><br><span class="line">  -w, --workdir string              Working directory inside the container</span><br></pre></td></tr></table></figure>
</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2018/02/05/docker/命令/run/" data-id="cjfeor73x002yw5h22aztaysi" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/Java开发规范" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/01/23/java/Java开发规范/">Java 编码规范</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/01/23/java/Java开发规范/">
            <time datetime="2018-01-23T05:20:56.000Z" itemprop="datePublished">2018-01-23</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Java/">Java</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Java/">Java</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="Java-编码规范"><a href="#Java-编码规范" class="headerlink" title="Java 编码规范"></a>Java 编码规范</h1><blockquote>
<p>编写时间：2018.01.20<br>编写人：CatalpaFlat</p>
</blockquote>
<h2 id="第1章-序言"><a href="#第1章-序言" class="headerlink" title="第1章    序言"></a>第1章    序言</h2><p>&emsp;&emsp;本规范的目的在于：建立一个可行可操作的编程标准、约定和指南，以规范公司java代码研发工作。<br>&emsp;&emsp;为了提高公司研发能力，该规范的制定是为了规范java代码开发，提高java开发质量，从代码的层面规范并提高java项目的研发水平。该规范由Java技术小组制定，组织技术人员对重点项目以及新的java项目定期检查，对代码质量进行评估，对代码质量较差限期整改，并报Java技术小组组长备案作为项目考核依据。<br>&emsp;&emsp;本规范的内容包括两个方面：编程规约、异常日志、单元测试、安全规约、工程结构、MySQL数据库六个维度。再根据内容特征，细分成若干二级子目录。<br>&emsp;&emsp;为了开发者针对违规代码进行调整，根据约束力强弱及故障敏感性：  </p>
<ul>
<li>规约级别：强制、推荐、参考三大类；<ul>
<li>“说明”：对内容做了适当扩展和解释，对于规约条目的延伸信息中；</li>
<li>“正例”：提倡什么样的编码和实现方式；</li>
<li>“反例”：说明需要提防的雷区，以及真实的错误案例。  </li>
</ul>
</li>
</ul>
<p>&emsp;&emsp;本规范解释权归Java技术小组，属于Java技术小组为了提供公司研发水平以及质量的一系列措施中的一部分，在后续的版本中将根据具体需要进行修改以及调整。技术小组审核后给出相应的整改意见，对于有争议的问题，可直接与Java技术小组组长沟通。   </p>
<h2 id="第2章-编程规约"><a href="#第2章-编程规约" class="headerlink" title="第2章    编程规约"></a>第2章    编程规约</h2><h3 id="2-1-命名规范"><a href="#2-1-命名规范" class="headerlink" title="2.1    命名规范"></a>2.1    命名规范</h3><p>1.【强制】代码中的命名均不能以下划线或美元符号开始，也不能以下划线或美元符号结束。<br>&emsp;反例：<em>name/__name/$Object/name</em>/name$/Object$<br>2.【强制】代码中的命名严禁使用拼音与英文混合的方式，更不允许直接使用中文的方式。<br>&emsp;说明：正确的英文拼写和语法可以让阅读者易于理解，避免歧义。注意，即使纯拼音命名方式也要避免采用。<br>&emsp;正例：alibaba / taobao / youku / hangzhou 等国际通用的名称，可视同英文。<br>&emsp;反例：DaZhePromotion [打折] / getPingfenByName() [评分] / int 某变量 = 3<br>3.【强制】类名使用UpperCamelCase风格，必须遵从驼峰形式，但以下情形例外：DO / BO / DTO / VO / AO / TO<br>&emsp;正例：MarcoPolo / UserDO / XmlService / TcpUdpDeal / TaPromotion<br>&emsp;反例：macroPolo / UserDo / XMLService / TCPUDPDeal / TAPromotion<br>4.【强制】方法名、参数名、成员变量、局部变量都统一使用lowerCamelCase风格，必须遵从驼峰形式。<br>&emsp;正例： localValue / getHttpMessage() / inputUserId<br>5.【强制】常量命名全部大写，单词间用下划线隔开，力求语义表达完整清楚，不要嫌名字长。<br>&emsp;正例：MAX_STOCK_COUNT<br>&emsp;反例：MAX_COUNT<br>6.【强制】抽象类命名使用Abstract或Base开头；异常类命名使用Exception结尾；测试类命名以它要测试的类的名称开始，以Test结尾。<br>7.【强制】中括号是数组类型的一部分，<br>&emsp;正例：数组定义如下：String[] args;<br>&emsp;反例：使用String args[]的方式来定义。<br>8.【强制】POJO类中布尔类型的变量，都不要加is，否则部分框架解析会引起序列化错误。<br>&emsp;反例：定义为基本数据类型Boolean isDeleted；的属性，它的方法也是isDeleted()，RPC框架在反向解析的时候，“以为”对应的属性名称是deleted，导致属性获取不到，进而抛出异常。<br>9.【强制】包名统一使用小写，点分隔符之间有且仅有一个自然语义的英语单词。包名统一使用单数形式，但是类名如果有复数含义，类名可以使用复数形式。<br>&emsp;正例： 应用工具类包名为com.alibaba.open.util、类名为MessageUtils（此规则参考spring的框架结构）<br>10.【强制】杜绝完全不规范的缩写，避免望文不知义。<br>&emsp;反例：AbstractClass“缩写”命名成AbsClass；condition“缩写”命名成 condi，此类随意缩写严重降低了代码的可阅读性。<br>11.【推荐】为了达到代码自解释的目标，任何自定义编程元素在命名时，使用尽量完整的单词组合来表达其意。<br>&emsp;正例：从远程仓库拉取代码的类命名为PullCodeFromRemoteRepository。<br>&emsp;反例：变量int a; 的随意命名方式。<br>12.【推荐】如果模块、接口、类、方法使用了设计模式，在命名时体现出具体模式。<br>&emsp;说明：将设计模式体现在名字中，有利于阅读者快速理解架构设计理念。<br>&emsp;正例：public class OrderFactory; public class LoginProxy; public class ResourceObserver;<br>13.【推荐】接口类中的方法和属性不要加任何修饰符号（public 也不要加），保持代码的简洁性，并加上有效的Javadoc注释。尽量不要在接口里定义变量，如果一定要定义变量，肯定是与接口方法相关，并且是整个应用的基础常量。<br>&emsp;正例：接口方法签名：void f(); 接口基础常量表示：String COMPANY = “alibaba”;<br>&emsp;反例：接口方法定义：public abstract void f();<br>&emsp;说明：JDK8中接口允许有默认实现，那么这个default方法，是对所有实现类都有价值的默认实现。<br>14.接口和实现类的命名有两套规则：<br> &emsp;1）【强制】对于Service和DAO类，基于SOA的理念，暴露出来的服务一定是接口，内部的实现类用Impl的后缀与接口区别。<br>&emsp;&emsp;正例：CacheServiceImpl实现CacheService接口。<br>&emsp; 2）【推荐】如果是形容能力的接口名称，取对应的形容词做接口名（通常是–able的形式）。<br>&emsp;&emsp;正例：AbstractTranslator实现 Translatable。<br>15.【参考】枚举类名建议带上Enum后缀，枚举成员名称需要全大写，单词间用下划线隔开。<br>&emsp;说明：枚举其实就是特殊的常量类，且构造方法被默认强制是私有。<br>&emsp;正例：枚举名字为ProcessStatusEnum的成员名称：SUCCESS / UNKOWN_REASON。<br>16.【参考】各层命名规约：<br>&emsp;A) Service/DAO层方法命名规约:<br>&emsp;&emsp;1） 获取单个对象的方法用get做前缀。<br>&emsp;&emsp;2） 获取多个对象的方法用list做前缀。<br>&emsp;&emsp;3） 获取统计值的方法用count做前缀。<br>&emsp;&emsp;4） 插入的方法用save/insert做前缀。<br>&emsp;&emsp;5） 删除的方法用remove/delete做前缀。<br>&emsp;&emsp;6） 修改的方法用update做前缀。<br>&emsp;B) 领域模型命名规约:<br>&emsp;&emsp;1） 数据对象：xxxDO，xxx即为数据表名。<br>&emsp;&emsp;2） 数据传输对象：xxxDTO，xxx为业务领域相关的名称。<br>&emsp;&emsp;3） 展示对象：xxxVO，xxx一般为网页名称。<br>&emsp;&emsp;4） POJO是DO/DTO/BO/VO的统称，禁止命名成xxxPOJO。  </p>
<h3 id="2-2-常量定义"><a href="#2-2-常量定义" class="headerlink" title="2.2    常量定义"></a>2.2    常量定义</h3><p>1.【强制】不允许任何魔法值（即未经定义的常量）直接出现在代码中。<br>&emsp;反例：String key = “Id#taobao_” + tradeId; cache.put(key, value);<br>2.【强制】long或者Long初始赋值时，使用大写的L，不能是小写的l，小写容易跟数字1混淆，造成误解。<br>&emsp;说明：Long a = 2l; 写的是数字的21，还是Long型的2?<br>3.【推荐】不要使用一个常量类维护所有常量，按常量功能进行归类，分开维护。<br>&emsp;说明：大而全的常量类，非得使用查找功能才能定位到修改的常量，不利于理解和维护。<br>&emsp;正例：缓存相关常量放在类CacheConsts下；系统配置相关常量放在类ConfigConsts下。<br>4.【推荐】常量的复用层次有五层：跨应用共享常量、应用内共享常量、子工程内共享常量、包内共享常量、类内共享常量。<br>&emsp;1） 跨应用共享常量：放置在二方库中，通常是client.jar中的constant目录下。<br>&emsp;2） 应用内共享常量：放置在一方库中，通常是modules中的constant目录下。<br>&emsp;反例：易懂变量也要统一定义成应用内共享常量，两位攻城师在两个类中分别定义了表示“是”的变量：   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//类A中：</span><br><span class="line">public static final String YES = &quot;yes&quot;;</span><br><span class="line">//类B中：</span><br><span class="line">public static final String YES = &quot;y&quot;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">		A.YES.equals(B.YES);//预期是true，但实际返回为false，导致线上问题。  </span><br><span class="line">```   </span><br><span class="line"></span><br><span class="line">&amp;emsp;3） 子工程内部共享常量：即在当前子工程的constant目录下。  </span><br><span class="line">&amp;emsp;4） 包内共享常量：即在当前包下单独的constant目录下。  </span><br><span class="line">&amp;emsp;5） 类内共享常量：直接在类内部private static final定义。  </span><br><span class="line"></span><br><span class="line">5.【推荐】如果变量值仅在一个范围内变化，且带有名称之外的延伸属性，定义为枚举类。下面正例中的数字就是延伸信息，表示星期几。  </span><br><span class="line">正例：</span><br></pre></td></tr></table></figure>
<pre><code>public Enum {
    MONDAY(1),
    TUESDAY(2),
    WEDNESDAY(3),
    THURSDAY(4),
    FRIDAY(5),
    SATURDAY(6),
    SUNDAY(7);
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.3	代码格式</span><br><span class="line">1.【强制】大括号的使用约定。如果是大括号内为空，则简洁地写成&#123;&#125;即可，不需要换行；如果是非空代码块则：  </span><br><span class="line">&amp;emsp;1） 左大括号前不换行。  </span><br><span class="line">&amp;emsp;2） 左大括号后换行。  </span><br><span class="line">&amp;emsp;3） 右大括号前换行。  </span><br><span class="line">&amp;emsp;4） 右大括号后还有else等代码则不换行；表示终止的右大括号后必须换行。   </span><br><span class="line">2.【强制】 左小括号和字符之间不出现空格；同样，右小括号和字符之间也不出现空格。详见第5条下方正例提示。  </span><br><span class="line">&amp;emsp;反例：if (空格a == b空格)  </span><br><span class="line">3.【强制】if/for/while/switch/do等保留字与括号之间都必须加空格。  </span><br><span class="line">4.【强制】任何二目、三目运算符的左右两边都需要加一个空格。   </span><br><span class="line">&amp;emsp;说明：运算符包括赋值运算符=、逻辑运算符&amp;&amp;、加减乘除符号等。   </span><br><span class="line">5.【强制】采用4个空格缩进，禁止使用tab字符。  </span><br><span class="line">&amp;emsp;说明：如果使用tab缩进，必须设置1个tab为4个空格。IDEA设置tab为4个空格时，请勿勾选Use tab character；而在eclipse中，必须勾选insert spaces for tabs。    </span><br><span class="line">&amp;emsp;正例： （涉及1-5点）</span><br></pre></td></tr></table></figure>
<pre><code>public static void main(String[] args) {
    // 缩进4个空格
    String say = &quot;hello&quot;;
    // 运算符的左右必须有一个空格
    int flag = 0;
    // 关键词if与括号之间必须有一个空格，括号内的f与左括号，0与右括号不需要空格
    if (flag == 0) {
      System.out.println(say);
    }
    // 左大括号前加空格且不换行；左大括号后换行
    if (flag == 1) {
      System.out.println(&quot;world&quot;);
      // 右大括号前换行，右大括号后有else，不用换行
    } else {
      System.out.println(&quot;ok&quot;);
      // 在右大括号后直接结束，则必须换行
    }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6.【强制】注释的双斜线与注释内容之间有且仅有一个空格。    </span><br><span class="line">&amp;emsp;正例：// 注释内容，注意在//和注释内容之间有一个空格。  </span><br><span class="line">7.【强制】单行字符数限制不超过120个，超出需要换行，换行时遵循如下原则：    </span><br><span class="line">&amp;emsp;1） 第二行相对第一行缩进4个空格，从第三行开始，不再继续缩进，参考示例。    </span><br><span class="line">&amp;emsp;2） 运算符与下文一起换行。  </span><br><span class="line">&amp;emsp;3） 方法调用的点符号与下文一起换行。  </span><br><span class="line">&amp;emsp;4） 方法调用时，多个参数，需要换行时，在逗号后进行。  </span><br><span class="line">&amp;emsp;5） 在括号前不要换行，见反例。  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure>
<pre><code>StringBuffer sb = new StringBuffer();
// 超过120个字符的情况下，换行缩进4个空格，点号和方法名称一起换行
sb.append(&quot;zi&quot;).append(&quot;xin&quot;)...
.append(&quot;huang&quot;)...
.append(&quot;huang&quot;)...
.append(&quot;huang&quot;);
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;emsp;反例：</span><br></pre></td></tr></table></figure>
<pre><code>StringBuffer sb = new StringBuffer();
// 超过120个字符的情况下，不要在括号前换行
sb.append(&quot;zi&quot;).append(&quot;xin&quot;)...append
(&quot;huang&quot;);
// 参数很多的方法调用可能超过120个字符，不要在逗号前换行
method(args1, args2, args3, ...
, argsX);  
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8.【强制】方法参数在定义和传入时，多个参数逗号后边必须加空格。  </span><br><span class="line">&amp;emsp;正例：下例中实参的&quot;a&quot;,后边必须要有一个空格。</span><br></pre></td></tr></table></figure>
<pre><code>method(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9.【强制】IDE的text file encoding设置为UTF-8; IDE中文件的换行符使用Unix格式，不要使用Windows格式。  </span><br><span class="line">10.【推荐】没有必要增加若干空格来使某一行的字符与上一行对应位置的字符对齐。  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure>
<pre><code>int a = 3;
long b = 4L;
float c = 5F;
StringBuffer sb = new StringBuffer();
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&amp;emsp;说明：增加sb这个变量，如果需要对齐，则给a、b、c都要增加几个空格，在变量比较多的情况下，是一种累赘的事情。  </span><br><span class="line">11.【推荐】方法体内的执行语句组、变量的定义语句组、不同的业务逻辑之间或者不同的语义之间插入一个空行。相同业务逻辑和语义之间不需要插入空行。  </span><br><span class="line">&amp;emsp;说明：没有必要插入多个空行进行隔开。      </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.4	OOP规约</span><br><span class="line">1.【强制】避免通过一个类的对象引用访问此类的静态变量或静态方法，无谓增加编译器解析成本，直接用类名来访问即可。    </span><br><span class="line">2.【强制】所有的覆写方法，必须加@Override注解。  </span><br><span class="line">&amp;emsp;说明：getObject()与get0bject()的问题。一个是字母的O，一个是数字的0，加@Override可以准确判断是否覆盖成功。另外，如果在抽象类中对方法签名进行修改，其实现类会马上编译报错。  </span><br><span class="line">3.【强制】相同参数类型，相同业务含义，才可以使用Java的可变参数，避免使用Object。  </span><br><span class="line">&amp;emsp;说明：可变参数必须放置在参数列表的最后。（提倡同学们尽量不用可变参数编程）  </span><br><span class="line">正例：</span><br></pre></td></tr></table></figure>
<pre><code>public User getUsers(String type, Integer... ids) {...}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4.【强制】外部正在调用或者二方库依赖的接口，不允许修改方法签名，避免对接口调用方产生影响。接口过时必须加@Deprecated注解，并清晰地说明采用的新接口或者新服务是什么。    </span><br><span class="line">5.【强制】不能使用过时的类或方法。  </span><br><span class="line">&amp;emsp;说明：java.net.URLDecoder 中的方法decode(String encodeStr) 这个方法已经过时，应该使用双参数decode(String source, String encode)。接口提供方既然明确是过时接口，那么有义务同时提供新的接口；作为调用方来说，有义务去考证过时方法的新实现是什么。  </span><br><span class="line">6.【强制】Object的equals方法容易抛空指针异常，应使用常量或确定有值的对象来调用equals。  </span><br><span class="line">&amp;emsp;正例：&quot;test&quot;.equals(object);  </span><br><span class="line">&amp;emsp;反例：object.equals(&quot;test&quot;);  </span><br><span class="line">&amp;emsp;说明：推荐使用java.util.Objects#equals（JDK7引入的工具类）  </span><br><span class="line">7.【强制】所有的相同类型的包装类对象之间值的比较，全部使用equals方法比较。  </span><br><span class="line">&amp;emsp;说明：对于Integer var = ? 在-128至127范围内的赋值，Integer对象是在IntegerCache.cache产生，会复用已有对象，这个区间内的Integer值可以直接使用==进行判断，但是这个区间之外的所有数据，都会在堆上产生，并不会复用已有对象，这是一个大坑，推荐使用equals方法进行判断。  </span><br><span class="line">8.关于基本数据类型与包装数据类型的使用标准如下：  </span><br><span class="line">&amp;emsp;1） 【强制】所有的POJO类属性必须使用包装数据类型。  </span><br><span class="line">&amp;emsp;2） 【强制】RPC方法的返回值和参数必须使用包装数据类型。  </span><br><span class="line">&amp;emsp;3） 【推荐】所有的局部变量使用基本数据类型。  </span><br><span class="line">&amp;emsp;说明：POJO类属性没有初值是提醒使用者在需要使用时，必须自己显式地进行赋值，任何NPE问题，或者入库检查，都由使用者来保证。  </span><br><span class="line">&amp;emsp;正例：数据库的查询结果可能是null，因为自动拆箱，用基本数据类型接收有NPE风险。  </span><br><span class="line">&amp;emsp;反例：比如显示成交总额涨跌情况，即正负x%，x为基本数据类型，调用的RPC服务，调用不成功时，返回的是默认值，页面显示为0%，这是不合理的，应该显示成中划线。所以包装数据类型的null值，能够表示额外的信息，如：远程调用失败，异常退出。  </span><br><span class="line">9.【强制】定义DO/DTO/VO等POJO类时，不要设定任何属性默认值。  </span><br><span class="line">&amp;emsp;反例：POJO类的gmtCreate默认值为new Date();但是这个属性在数据提取时并没有置入具体值，在更新其它字段时又附带更新了此字段，导致创建时间被修改成当前时间。   </span><br><span class="line">10.【强制】序列化类新增属性时，请不要修改serialVersionUID字段，避免反序列失败；如果完全不兼容升级，避免反序列化混乱，那么请修改serialVersionUID值。  </span><br><span class="line">&amp;emsp;说明：注意serialVersionUID不一致会抛出序列化运行时异常。    </span><br><span class="line">11.【强制】构造方法里面禁止加入任何业务逻辑，如果有初始化逻辑，请放在init方法中。   </span><br><span class="line">12.【强制】POJO类必须写toString方法。使用IDE的中工具：source&gt; generate toString时，如果继承了另一个POJO类，注意在前面加一下super.toString。   </span><br><span class="line">&amp;emsp;说明：在方法执行抛出异常时，可以直接调用POJO的toString()方法打印其属性值，便于排查问题。  </span><br><span class="line">13.【推荐】使用索引访问用String的split方法得到的数组时，需做最后一个分隔符后有无内容的检查，否则会有抛IndexOutOfBoundsException的风险。   </span><br><span class="line">&amp;emsp;说明：</span><br></pre></td></tr></table></figure>
<pre><code>String str = &quot;a,b,c,,&quot;;
String[] ary = str.split(&quot;,&quot;);
// 预期大于3，结果是3
System.out.println(ary.length);
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">14.【推荐】当一个类有多个构造方法，或者多个同名方法，这些方法应该按顺序放置在一起，便于阅读，此条规则优先于第15条规则。  </span><br><span class="line">15.【推荐】 类内方法定义顺序依次是：公有方法或保护方法 &gt; 私有方法 &gt; getter/setter方法。  </span><br><span class="line">&amp;emsp;说明：公有方法是类的调用者和维护者最关心的方法，首屏展示最好；保护方法虽然只是子类关心，也可能是“模板设计模式”下的核心方法；而私有方法外部一般不需要特别关心，是一个黑盒实现；因为承载的信息价值较低，所有Service和DAO的getter/setter方法放在类体最后。     </span><br><span class="line">16.【推荐】setter方法中，参数名称与类成员变量名称一致，this.成员名 = 参数名。在getter/setter方法中，不要增加业务逻辑，增加排查问题的难度。  </span><br><span class="line">&amp;emsp;反例：</span><br></pre></td></tr></table></figure>
<pre><code>public Integer getData() {
    if (true) {
        return this.data + 100;
    } else {
        return this.data - 100;
    }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">17.【推荐】循环体内，字符串的连接方式，使用StringBuilder的append方法进行扩展。  </span><br><span class="line">&amp;emsp;说明：反编译出的字节码文件显示每次循环都会new出一个StringBuilder对象，然后进行append操作，最后通过toString方法返回String对象，造成内存资源浪费。   </span><br><span class="line">&amp;emsp;反例：</span><br></pre></td></tr></table></figure>
<pre><code>String str = &quot;start&quot;;
for (int i = 0; i &lt; 100; i++) {
str = str + &quot;hello&quot;;
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">18.【推荐】final可以声明类、成员变量、方法、以及本地变量，下列情况使用final关键字：  </span><br><span class="line">&amp;emsp;1） 不允许被继承的类，如：String类。  </span><br><span class="line">&amp;emsp;2） 不允许修改引用的域对象，如：POJO类的域变量。  </span><br><span class="line">&amp;emsp;3） 不允许被重写的方法，如：POJO类的setter方法。  </span><br><span class="line">&amp;emsp;4） 不允许运行过程中重新赋值的局部变量。  </span><br><span class="line">&amp;emsp;5） 避免上下文重复使用一个变量，使用final描述可以强制重新定义一个变量，方便更好地进行重构。   </span><br><span class="line">19.【推荐】慎用Object的clone方法来拷贝对象。  </span><br><span class="line">&amp;emsp;说明：对象的clone方法默认是浅拷贝，若想实现深拷贝需要重写clone方法实现属性对象的拷贝。   </span><br><span class="line">20.【推荐】类成员与方法访问控制从严：   </span><br><span class="line">&amp;emsp;1） 如果不允许外部直接通过new来创建对象，那么构造方法必须是private。  </span><br><span class="line">&amp;emsp;2） 工具类不允许有public或default构造方法。  </span><br><span class="line">&amp;emsp;3） 类非static成员变量并且与子类共享，必须是protected。  </span><br><span class="line">&amp;emsp;4） 类非static成员变量并且仅在本类使用，必须是private。  </span><br><span class="line">&amp;emsp;5） 类static成员变量如果仅在本类使用，必须是private。  </span><br><span class="line">&amp;emsp;6） 若是static成员变量，必须考虑是否为final。  </span><br><span class="line">&amp;emsp;7） 类成员方法只供类内部调用，必须是private。  </span><br><span class="line">&amp;emsp;8） 类成员方法只对继承类公开，那么限制为protected。  </span><br><span class="line">&amp;emsp;说明：任何类、方法、参数、变量，严控访问范围。过于宽泛的访问范围，不利于模块解耦。思考：如果是一个private的方法，想删除就删除，可是一个public的service方法，或者一个public的成员变量，删除一下，不得手心冒点汗吗？变量像自己的小孩，尽量在自己的视线内，变量作用域太大，无限制的到处跑，那么你会担心的。   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.5	集合规约  </span><br><span class="line">1.【强制】关于hashCode和equals的处理，遵循如下规则：  </span><br><span class="line">&amp;emsp;1） 只要重写equals，就必须重写hashCode。  </span><br><span class="line">&amp;emsp;2） 因为Set存储的是不重复的对象，依据hashCode和equals进行判断，所以Set存储的对象必须重写这两个方法。  </span><br><span class="line">&amp;emsp;3） 如果自定义对象做为Map的键，那么必须重写hashCode和equals。</span><br><span class="line">说明：String重写了hashCode和equals方法，所以我们可以非常愉快地使用String对象作为key来使用。  </span><br><span class="line">2.【强制】 ArrayList的subList结果不可强转成ArrayList，否则会抛出ClassCastException异常，即java.util.RandomAccessSubList cannot be cast to java.util.ArrayList.   </span><br><span class="line">&amp;emsp;说明：subList 返回的是 ArrayList 的内部类 SubList，并不是 ArrayList ，而是 ArrayList 的一个视图，对于SubList子列表的所有操作最终会反映到原列表上。  </span><br><span class="line">3.【强制】在subList场景中，高度注意对原集合元素个数的修改，会导致子列表的遍历、增加、删除均会产生ConcurrentModificationException 异常。  </span><br><span class="line">4.【强制】使用集合转数组的方法，必须使用集合的toArray(T[] array)，传入的是类型完全一样的数组，大小就是list.size()。  </span><br><span class="line">&amp;emsp;说明：使用toArray带参方法，入参分配的数组空间不够大时，toArray方法内部将重新分配内存空间，并返回新数组地址；如果数组元素大于实际所需，下标为[ list.size() ]的数组元素将被置为null，其它数组元素保持原值，因此最好将方法入参数组大小定义与集合元素个数一致。  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure>
<pre><code>List&lt;String&gt; list = new ArrayList&lt;String&gt;(2);
list.add(&quot;guan&quot;);
list.add(&quot;bao&quot;);
String[] array = new String[list.size()];
array = list.toArray(array);
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&amp;emsp;反例：直接使用toArray无参方法存在问题，此方法返回值只能是Object[]类，若强转其它类型数组将出现ClassCastException错误。  </span><br><span class="line">5.【强制】使用工具类Arrays.asList()把数组转换成集合时，不能使用其修改集合相关的方法，它的add/remove/clear方法会抛出 UnsupportedOperationException异常。  </span><br><span class="line">&amp;emsp;说明：asList的返回对象是一个Arrays内部类，并没有实现集合的修改方法。Arrays.asList体现的是适配器模式，只是转换接口，后台的数据仍是数组。</span><br></pre></td></tr></table></figure>
<pre><code>String[] str = new String[] { &quot;you&quot;, &quot;wu&quot; };
List list = Arrays.asList(str);
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&amp;emsp;&amp;emsp;第一种情况：list.add(&quot;yangguanbao&quot;); 运行时异常。  </span><br><span class="line">&amp;emsp;&amp;emsp;第二种情况：str[0] = &quot;gujin&quot;; 那么list.get(0)也会随之修改。  </span><br><span class="line">6.【强制】泛型通配符&lt;? extends T&gt;来接收返回的数据，此写法的泛型集合不能使用add方法，而&lt;? super T&gt;不能使用get方法，做为接口调用赋值时易出错。  </span><br><span class="line">&amp;emsp;说明：扩展说一下PECS(Producer Extends Consumer Super)原则：  </span><br><span class="line">&amp;emsp;&amp;emsp;第一、频繁往外读取内容的，适合用&lt;? extends T&gt;。  </span><br><span class="line">&amp;emsp;&amp;emsp;第二、经常往里插入的，适合用&lt;? super T&gt;。  </span><br><span class="line">7.【强制】不要在foreach循环里进行元素的remove/add操作。remove元素请使用Iterator方式，如果并发操作，需要对Iterator对象加锁。  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure>
<p>  Iterator<string> iterator = list.iterator();<br>    while (iterator.hasNext()) {<br>      String item = iterator.next();<br>      if (删除元素的条件) {<br>        iterator.remove();<br>      }<br>  }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&amp;emsp;反例：</span><br></pre></td></tr></table></figure></string></p>
<pre><code>List&lt;String&gt; list = new ArrayList&lt;String&gt;();
list.add(&quot;1&quot;);
list.add(&quot;2&quot;);
for (String item : list) {
  if (&quot;1&quot;.equals(item)) {
     list.remove(item);
  }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&amp;emsp;说明：以上代码的执行结果肯定会出乎大家的意料，那么试一下把“1”换成“2”，会是同样的结果吗？  </span><br><span class="line">8.【强制】 在JDK7版本及以上，Comparator要满足如下三个条件，不然Arrays.sort，Collections.sort会报IllegalArgumentException异常。  </span><br><span class="line">&amp;emsp;说明：三个条件如下  </span><br><span class="line">&amp;emsp;&amp;emsp;1） x，y的比较结果和y，x的比较结果相反。  </span><br><span class="line">&amp;emsp;&amp;emsp;2） x&gt;y，y&gt;z，则x&gt;z。  </span><br><span class="line">&amp;emsp;&amp;emsp;3） x=y，则x，z比较结果和y，z比较结果相同。  </span><br><span class="line">&amp;emsp;反例：下例中没有处理相等的情况，实际使用中可能会出现异常：</span><br></pre></td></tr></table></figure>
<pre><code>new Comparator&lt;Student&gt;() {
    @Override
    public int compare(Student o1, Student o2) {
        return o1.getId() &gt; o2.getId() ? 1 : -1;
    }
};
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">9.【推荐】集合初始化时，指定集合初始值大小。  </span><br><span class="line">&amp;emsp;说明：HashMap使用HashMap(int initialCapacity) 初始化，  </span><br><span class="line">&amp;emsp;正例：initialCapacity =(需要存储的元素个数 / 负载因子) + 1。注意负载因子（即loader factor）默认为0.75，如果暂时无法确定初始值大小，请设置为16（即默认值）。  </span><br><span class="line">&amp;emsp;反例：HashMap需要放置1024个元素，由于没有设置容量初始大小，随着元素不断增加，容量7次被迫扩大，resize需要重建hash表，严重影响性能。  </span><br><span class="line">10.【推荐】使用entrySet遍历Map类集合KV，而不是keySet方式进行遍历。  </span><br><span class="line">&amp;emsp;说明：keySet其实是遍历了2次，一次是转为Iterator对象，另一次是从hashMap中取出key所对应的value。而entrySet只是遍历了一次就把key和value都放到了entry中，效率更高。如果是JDK8，使用Map.foreach方法。</span><br><span class="line">&amp;emsp;正例：values()返回的是V值集合，是一个list集合对象；keySet()返回的是K值集合，是一个Set集合对象；entrySet()返回的是K-V值组合集合。  </span><br><span class="line">11.【推荐】高度注意Map类集合K/V能不能存储null值的情况，如下表格：  </span><br><span class="line"></span><br><span class="line">| 集合类 | Key |	Value |	Super |	说明</span><br><span class="line">|----|----|----|----|----|</span><br><span class="line">|Hashtable |	不允许为null|	不允许为null |	Dictionary| 	线程安全</span><br><span class="line">|ConcurrentHashMap 	|不允许为null 	|不允许为null 	|AbstractMap |	锁分段技术（JDK8:CAS）</span><br><span class="line">|TreeMap 	|不允许为null| 	允许为null |	AbstractMap |	线程不安全</span><br><span class="line">|HashMap |	允许为null |	允许为null |	AbstractMap |	线程不安全</span><br><span class="line">&amp;emsp;反例： 由于HashMap的干扰，很多人认为ConcurrentHashMap是可以置入null值，而事实上，存储null值时会抛出NPE异常。  </span><br><span class="line">12.【参考】合理利用好集合的有序性(sort)和稳定性(order)，避免集合的无序性(unsort)和不稳定性(unorder)带来的负面影响。   </span><br><span class="line">&amp;emsp;说明：有序性是指遍历的结果是按某种比较规则依次排列的。稳定性指集合每次遍历的元素次序是一定的。如：ArrayList是order/unsort；HashMap是unorder/unsort；TreeSet是order/sort。  </span><br><span class="line">13.【参考】利用Set元素唯一的特性，可以快速对一个集合进行去重操作，避免使用List的contains方法进行遍历、对比、去重操作。   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.6 并发规约</span><br><span class="line">1.【强制】获取单例对象需要保证线程安全，其中的方法也要保证线程安全。  </span><br><span class="line">&amp;emsp;说明：资源驱动类、工具类、单例工厂类都需要注意。  </span><br><span class="line">2.【强制】创建线程或线程池时请指定有意义的线程名称，方便出错时回溯。  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure>
<pre><code>public class TimerTaskThread extends Thread {  
  public TimerTaskThread() {  
    super.setName(&quot;TimerTaskThread&quot;);  
    ...  
  }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3.【强制】线程资源必须通过线程池提供，不允许在应用中自行显式创建线程。  </span><br><span class="line">&amp;emsp;说明：使用线程池的好处是减少在创建和销毁线程上所花的时间以及系统资源的开销，解决资源不足的问题。如果不使用线程池，有可能造成系统创建大量同类线程而导致消耗完内存或者“过度切换”的问题。  </span><br><span class="line"></span><br><span class="line">4.【强制】线程池不允许使用Executors去创建，而是通过ThreadPoolExecutor的方式，这样的处理方式让写的同学更加明确线程池的运行规则，规避资源耗尽的风险。  </span><br><span class="line">&amp;emsp;说明：Executors返回的线程池对象的弊端如下：  </span><br><span class="line">&amp;emsp;&amp;emsp;1）FixedThreadPool和SingleThreadPool:允许的请求队列长度为Integer.MAX_VALUE，可能会堆积大量的请求，从而导致OOM。  </span><br><span class="line">&amp;emsp;&amp;emsp;2）CachedThreadPool和ScheduledThreadPool:允许的创建线程数量为Integer.MAX_VALUE，可能会创建大量的线程，从而导致OOM。</span><br><span class="line"></span><br><span class="line">5.【强制】SimpleDateFormat 是线程不安全的类，一般不要定义为static变量，如果定义为static，必须加锁，或者使用DateUtils工具类。  </span><br><span class="line">&amp;emsp;正例：注意线程安全，使用DateUtils。亦推荐如下处理：</span><br></pre></td></tr></table></figure>
<pre><code>private static final ThreadLocal&lt;DateFormat&gt; df = new ThreadLocal&lt;DateFormat&gt;() {  
  @Override  
  protected DateFormat initialValue() {  
    return new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);  
  }  
};  
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&amp;emsp;说明：如果是JDK8的应用，可以使用Instant代替Date，LocalDateTime代替Calendar，DateTimeFormatter代替SimpleDateFormat，官方给出的解释：simple beautiful strong immutable thread-safe。  </span><br><span class="line">6.【强制】高并发时，同步调用应该去考量锁的性能损耗。能用无锁数据结构，就不要用锁；能锁区块，就不要锁整个方法体；能用对象锁，就不要用类锁。  </span><br><span class="line">&amp;emsp;说明：尽可能使加锁的代码块工作量尽可能的小，避免在锁代码块中调用RPC方法。  </span><br><span class="line">7.【强制】对多个资源、数据库表、对象同时加锁时，需要保持一致的加锁顺序，否则可能会造成死锁。  </span><br><span class="line">&amp;emsp;说明：线程一需要对表A、B、C依次全部加锁后才可以进行更新操作，那么线程二的加锁顺序也必须是A、B、C，否则可能出现死锁。  </span><br><span class="line">8.【强制】并发修改同一记录时，避免更新丢失，需要加锁。要么在应用层加锁，要么在缓存加锁，要么在数据库层使用乐观锁，使用version作为更新依据。  </span><br><span class="line">&amp;emsp;说明：如果每次访问冲突概率小于20%，推荐使用乐观锁，否则使用悲观锁。乐观锁的重试次数不得小于3次。  </span><br><span class="line">9.【强制】多线程并行处理定时任务时，Timer运行多个TimeTask时，只要其中之一没有捕获抛出的异常，其它任务便会自动终止运行，使用ScheduledExecutorService则没有这个问题。  </span><br><span class="line">10.【推荐】使用CountDownLatch进行异步转同步操作，每个线程退出前必须调用countDown方法，线程执行代码注意catch异常，确保countDown方法被执行到，避免主线程无法执行至await方法，直到超时才返回结果。   </span><br><span class="line">&amp;emsp;说明：注意，子线程抛出异常堆栈，不能在主线程try-catch到。   </span><br><span class="line">11.【推荐】避免Random实例被多线程使用，虽然共享该实例是线程安全的，但会因竞争同一seed 导致的性能下降。  </span><br><span class="line">&amp;emsp;说明：Random实例包括java.util.Random 的实例或者 Math.random()的方式。  </span><br><span class="line">&amp;emsp;正例：在JDK7之后，可以直接使用API ThreadLocalRandom，而在 JDK7之前，需要编码保证每个线程持有一个实例。  </span><br><span class="line">12.【推荐】在并发场景下，通过双重检查锁（double-checked locking）实现延迟初始化的优化问题隐患(可参考 The &quot;Double-Checked Locking is Broken&quot; Declaration)，推荐解决方案中较为简单一种（适用于JDK5及以上版本），将目标属性声明为 volatile型。  </span><br><span class="line">&amp;emsp;反例：</span><br></pre></td></tr></table></figure>
<pre><code>class Singleton {
  private Helper helper = null;
  public Helper getHelper() {
    if (helper == null) synchronized(this) {
      if (helper == null)
      helper = new Helper();
    }
      return helper;
  }
  // other methods and fields...
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">13.【参考】volatile解决多线程内存不可见问题。对于一写多读，是可以解决变量同步问题，但是如果多写，同样无法解决线程安全问题。如果是count++操作，使用如下类实现：AtomicInteger count = new AtomicInteger(); count.addAndGet(1); 如果是JDK8，推荐使用LongAdder对象，比AtomicLong性能更好（减少乐观锁的重试次数）。  </span><br><span class="line">14.【参考】HashMap在容量不够进行resize时由于高并发可能出现死链，导致CPU飙升，在开发过程中可以使用其它数据结构或加锁来规避此风险。  </span><br><span class="line">15.【参考】ThreadLocal无法解决共享对象的更新问题，ThreadLocal对象建议使用static修饰。这个变量是针对一个线程内所有操作共享的，所以设置为静态变量，所有此类实例共享此静态变量 ，也就是说在类第一次被使用时装载，只分配一块存储空间，所有此类的对象(只要是这个线程内定义的)都可以操控这个变量。  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.7 控制语句</span><br><span class="line">1.【强制】在一个switch块内，每个case要么通过break/return等来终止，要么注释说明程序将继续执行到哪一个case为止；在一个switch块内，都必须包含一个default语句并且放在最后，即使它什么代码也没有。  </span><br><span class="line">2.【强制】在if/else/for/while/do语句中必须使用大括号。即使只有一行代码，避免采用单行的编码方式：if (condition) statements;   </span><br><span class="line">3.【推荐】表达异常的分支时，少用if-else方式，这种方式可以改写成：</span><br></pre></td></tr></table></figure>
<p>  if (condition) {<br>  …<br>  return obj;<br>  }<br>  // 接着写else的业务逻辑代码;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;emsp;说明：如果非得使用if()...else if()...else...方式表达逻辑，【强制】避免后续代码维护困难，请勿超过3层。  </span><br><span class="line">&amp;emsp;正例：超过3层的 if-else 的逻辑判断代码可以使用卫语句、策略模式、状态模式等来实现，其中卫语句示例如下：</span><br></pre></td></tr></table></figure></p>
<p>public void today() {<br>  if (isBusy()) {<br>    System.out.println(“change time.”);<br>    return;<br>  }<br>  if (isFree()) {<br>    System.out.println(“go to travel.”);<br>    retur<br>  }<br>  System.out.println(“stay at home to learn Alibaba Java Coding Guidelines.”);<br>  return;<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4.【推荐】除常用方法（如getXxx/isXxx）等外，不要在条件判断中执行其它复杂的语句，将复杂逻辑判断的结果赋值给一个有意义的布尔变量名，以提高可读性。    </span><br><span class="line">&amp;emsp;说明：很多if语句内的逻辑相当复杂，阅读者需要分析条件表达式的最终结果，才能明确什么样的条件执行什么样的语句，那么，如果阅读者分析逻辑表达式错误呢？  </span><br><span class="line">&amp;emsp;正例：</span><br></pre></td></tr></table></figure></p>
<p>// 伪代码如下<br>final boolean existed = (file.open(fileName, “w”) != null) &amp;&amp; (…) || (…);<br>if (existed) {<br>…<br>}<br>反例： if ((file.open(fileName, “w”) != null) &amp;&amp; (…) || (…)) {<br>…<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">5.【推荐】循环体中的语句要考量性能，以下操作尽量移至循环体外处理，如定义对象、变量、获取数据库连接，进行不必要的try-catch操作（这个try-catch是否可以移至循环体外）。  </span><br><span class="line">6.【推荐】接口入参保护，这种场景常见的是用于做批量操作的接口。   </span><br><span class="line">7.【参考】下列情形，需要进行参数校验：  </span><br><span class="line">&amp;emsp;1） 调用频次低的方法。   </span><br><span class="line">&amp;emsp;2） 执行时间开销很大的方法。此情形中，参数校验时间几乎可以忽略不计，但如果因为参数错误导致中间执行回退，或者错误，那得不偿失。  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&amp;emsp;3） 需要极高稳定性和可用性的方法。   </span><br><span class="line">&amp;emsp;4） 对外提供的开放接口，不管是RPC/API/HTTP接口。  </span><br><span class="line">&amp;emsp;5） 敏感权限入口。  </span><br><span class="line">8.【参考】下列情形，不需要进行参数校验：   </span><br><span class="line">&amp;emsp;1） 极有可能被循环调用的方法。但在方法说明里必须注明外部参数检查要求。  </span><br><span class="line">&amp;emsp;2） 底层调用频度比较高的方法。毕竟是像纯净水过滤的最后一道，参数错误不太可能到底层才会暴露问题。一般DAO层与Service层都在同一个应用中，部署在同一台服务器中，所以DAO的参数校验，可以省略。  </span><br><span class="line">&amp;emsp;3） 被声明成private只会被自己代码所调用的方法，如果能够确定调用方法的代码传入参数已经做过检查或者肯定不会有问题，此时可以不校验参数。   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.8 注释规约</span><br><span class="line">1.【强制】类、类属性、类方法的注释必须使用Javadoc规范，使用/** 内容*/格式，不得使用// xxx方式。   </span><br><span class="line">&amp;emsp;说明：在IDE编辑窗口中，Javadoc方式会提示相关注释，生成Javadoc可以正确输出相应注释；在IDE中，工程调用方法时，不进入方法即可悬浮提示方法、参数、返回值的意义，提高阅读效率。  </span><br><span class="line">2.【强制】所有的抽象方法（包括接口中的方法）必须要用Javadoc注释、除了返回值、参数、异常说明外，还必须指出该方法做什么事情，实现什么功能。 说明：对子类的实现要求，或者调用注意事项，请一并说明。  </span><br><span class="line">3.【强制】所有的类都必须添加创建者和创建日期。  </span><br><span class="line">4.【强制】方法内部单行注释，在被注释语句上方另起一行，使用//注释。方法内部多行注释使用&apos;/*&apos; &apos;*/&apos;注释，注意与代码对齐。  </span><br><span class="line">5.【强制】所有的枚举类型字段必须要有注释，说明每个数据项的用途。  </span><br><span class="line">6.【推荐】与其“半吊子”英文来注释，不如用中文注释把问题说清楚。专有名词与关键字保持英文原文即可。  </span><br><span class="line">&amp;emsp;反例：“TCP连接超时”解释成“传输控制协议连接超时”，理解反而费脑筋。  </span><br><span class="line">7.【推荐】代码修改的同时，注释也要进行相应的修改，尤其是参数、返回值、异常、核心逻辑等的修改。  </span><br><span class="line">&amp;emsp;说明：代码与注释更新不同步，就像路网与导航软件更新不同步一样，如果导航软件严重滞后，就失去了导航的意义。  </span><br><span class="line">8.【参考】谨慎注释掉代码。在上方详细说明，而不是简单地注释掉。如果无用，则删除。  </span><br><span class="line">&amp;emsp;说明：代码被注释掉有两种可能性：  </span><br><span class="line">&amp;emsp;&amp;emsp;1）后续会恢复此段代码逻辑。  </span><br><span class="line">&amp;emsp;&amp;emsp;2）永久不用。前者如果没有备注信息，难以知晓注释动机。后者建议直接删掉（代码仓库保存了历史代码）。  </span><br><span class="line">9.【参考】对于注释的要求：  </span><br><span class="line">&amp;emsp;第一、能够准确反应设计思想和代码逻辑；  </span><br><span class="line">&amp;emsp;第二、能够描述业务含义，使别的程序员能够迅速了解到代码背后的信息。完全没有注释的大段代码对于阅读者形同天书，注释是给自己看的，即使隔很长时间，也能清晰理解当时的思路；注释也是给继任者看的，使其能够快速接替自己的工作。  </span><br><span class="line">10.【参考】好的命名、代码结构是自解释的，注释力求精简准确、表达到位。避免出现注释的一个极端：过多过滥的注释，代码的逻辑一旦修改，修改注释是相当大的负担。    </span><br><span class="line">反例：</span><br></pre></td></tr></table></figure></p>
<p>// put elephant into fridge<br>put(elephant, fridge);<br><code>`</code><br>方法名put，加上两个有意义的变量名elephant和fridge，已经说明了这是在干什么，语义清晰的代码不需要额外的注释。   </p>
<p>11.【参考】特殊注释标记，请注明标记人与标记时间。注意及时处理这些标记，通过标记扫描，经常清理此类标记。线上故障有时候就是来源于这些标记处的代码。<br>&emsp;1） 待办事宜（TODO）:（ 标记人，标记时间，[预计处理时间]） 表示需要实现，但目前还未实现的功能。这实际上是一个Javadoc的标签，目前的Javadoc还没有实现，但已经被广泛使用。只能应用于类，接口和方法（因为它是一个Javadoc标签）。<br>&emsp;2） 错误，不能工作（FIXME）:（标记人，标记时间，[预计处理时间]） 在注释中用FIXME标记某代码是错误的，而且不能工作，需要及时纠正的情况。   </p>
<h2 id="第3章-异常日志"><a href="#第3章-异常日志" class="headerlink" title="第3章    异常日志"></a>第3章    异常日志</h2><h3 id="3-1-异常处理"><a href="#3-1-异常处理" class="headerlink" title="3.1 异常处理"></a>3.1 异常处理</h3>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2018/01/23/java/Java开发规范/" data-id="cjfeor723000rw5h2udenlzh3" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-docker/安装/docker安装" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2018/01/05/docker/安装/docker安装/">CentOS Docker 安装</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/01/05/docker/安装/docker安装/">
            <time datetime="2018-01-05T08:33:56.000Z" itemprop="datePublished">2018-01-05</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/docker/">docker</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/docker/">docker</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="CentOS-Docker-安装"><a href="#CentOS-Docker-安装" class="headerlink" title="CentOS Docker 安装"></a>CentOS Docker 安装</h1><blockquote>
<p>Docker支持以下的CentOS版本：</p>
<ul>
<li>CentOS 7 (64-bit)</li>
<li>CentOS 6.5 (64-bit) 或更高的版本</li>
</ul>
</blockquote>
<blockquote>
<p>前提条件:<br>目前，CentOS 仅发行版本中的内核支持 Docker。<br>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。<br>Docker 运行在 CentOS-6.5 或更高的版本的 CentOS 上，要求系统为64位、系统内核版本为 2.6.32-431 或者更高版本。<br>使用 yum 安装（CentOS 7下）</p>
</blockquote>
<h2 id="1-检测版本"><a href="#1-检测版本" class="headerlink" title="1. 检测版本"></a>1. 检测版本</h2><p>Docker 要求 CentOS 系统的内核版本高于 3.10 ，查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker 。<br>通过 uname -r 命令查看你当前的内核版本<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure></p>
<h2 id="2-安装-Docker"><a href="#2-安装-Docker" class="headerlink" title="2. 安装 Docker"></a>2. 安装 Docker</h2><p>Docker 软件包和依赖包已经包含在默认的 CentOS-Extras 软件源里，安装命令如下：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.runoob.com/wp-content/uploads/2016/05/docker09.png" alt=""></p>
<h2 id="3-启动-Docker-后台服务"><a href="#3-启动-Docker-后台服务" class="headerlink" title="3. 启动 Docker 后台服务"></a>3. 启动 Docker 后台服务</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure>
<p><img src="http://www.runoob.com/wp-content/uploads/2016/05/docker11.png" alt=""></p>
<h2 id="4-镜像加速"><a href="#4-镜像加速" class="headerlink" title="4.镜像加速"></a>4.镜像加速</h2><p>鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决，我使用的是网易的镜像地址：<a href="http://hub-mirror.c.163.com。" target="_blank" rel="noopener">http://hub-mirror.c.163.com。</a><br>新版的 Docker 使用 /etc/docker/daemon.json（Linux） 或者 %programdata%\docker\config\daemon.json（Windows） 来配置 Daemon。<br>请在该配置文件中加入（没有该文件的话，请先建一个）：<br>{<br>  “registry-mirrors”: [“<a href="http://hub-mirror.c.163.com&quot;]" target="_blank" rel="noopener">http://hub-mirror.c.163.com&quot;]</a><br>}</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2018/01/05/docker/安装/docker安装/" data-id="cjfeor73w002xw5h27b7s1d8u" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/Java 实现中文-拼音转换" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/12/16/java/Java 实现中文-拼音转换/">Java 实现中文-拼音转换</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/12/16/java/Java 实现中文-拼音转换/">
            <time datetime="2017-12-16T02:16:56.000Z" itemprop="datePublished">2017-12-16</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Java/">Java</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Java/">Java</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="Java-实现中文-拼音转换"><a href="#Java-实现中文-拼音转换" class="headerlink" title="Java 实现中文-拼音转换"></a>Java 实现中文-拼音转换</h1><pre><code>/**
 * 中文转拼音
 *
 * @author ： CatalpaFlat
 */
public class ChineseToPinyinUtil {
    /**
     * 将文字转为汉语拼音
     *
     * @param chineseLanguage 要转成拼音的中文
     */
    public static String toHanyuPinyin(String chineseLanguage) {
        char[] clChars = chineseLanguage.trim().toCharArray();
        StringBuilder hanyupinyin = new StringBuilder();
        HanyuPinyinOutputFormat defaultFormat = new HanyuPinyinOutputFormat();
        // 输出拼音全部小写
        defaultFormat.setCaseType(HanyuPinyinCaseType.LOWERCASE);
        // 不带声调
        defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);
        defaultFormat.setVCharType(HanyuPinyinVCharType.WITH_V);
        try {
            for (char clChar : clChars) {
                // 如果字符是中文,则将中文转为汉语拼音
                if (String.valueOf(clChar).matches(&quot;[\u4e00-\u9fa5]+&quot;)) {
                    hanyupinyin.append(PinyinHelper.toHanyuPinyinStringArray(clChar, defaultFormat)[0]);
                    // 如果字符不是中文,则不转换
                } else {
                    hanyupinyin.append(clChar);
                }
            }
        } catch (BadHanyuPinyinOutputFormatCombination e) {
            System.out.println(&quot;字符不能转成汉语拼音&quot;);
        }
        return hanyupinyin.toString();
    }

    public static String getFirstLettersUp(String chineseLanguage) {
        return getFirstLetters(chineseLanguage, HanyuPinyinCaseType.UPPERCASE);
    }

    public static String getFirstLettersLo(String chineseLanguage) {
        return getFirstLetters(chineseLanguage, HanyuPinyinCaseType.LOWERCASE);
    }

    private static String getFirstLetters(String chineseLanguage, HanyuPinyinCaseType caseType) {
        char[] clChars = chineseLanguage.trim().toCharArray();
        StringBuilder hanyupinyin = new StringBuilder();
        HanyuPinyinOutputFormat defaultFormat = new HanyuPinyinOutputFormat();
        // 输出拼音全部大写
        defaultFormat.setCaseType(caseType);
        // 不带声调
        defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);
        try {
            for (char clChar : clChars) {
                String str = String.valueOf(clChar);
                // 如果字符是中文,则将中文转为汉语拼音,并取第一个字母
                if (str.matches(&quot;[\u4e00-\u9fa5]+&quot;)) {
                    hanyupinyin.append(PinyinHelper.toHanyuPinyinStringArray(clChar, defaultFormat)[0].substring(0, 1));
                    // 如果字符是数字,取数字
                } else if (str.matches(&quot;[0-9]+&quot;)) {
                    hanyupinyin.append(clChar);
                    // 如果字符是字母,取字母
                } else if (str.matches(&quot;[a-zA-Z]+&quot;)) {
                    hanyupinyin.append(clChar);
                    //如果是标点符号的话，带着
                } else {// 否则不转换
                    hanyupinyin.append(clChar);
                }
            }
        } catch (BadHanyuPinyinOutputFormatCombination e) {
            System.out.println(&quot;字符不能转成汉语拼音&quot;);
        }
        return hanyupinyin.toString();
    }

    public static String getPinyinString(String chineseLanguage) {
        char[] clChars = chineseLanguage.trim().toCharArray();
        StringBuilder hanyupinyin = new StringBuilder();
        HanyuPinyinOutputFormat defaultFormat = new HanyuPinyinOutputFormat();
        // 输出拼音全部大写
        defaultFormat.setCaseType(HanyuPinyinCaseType.LOWERCASE);
        // 不带声调
        defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);
        try {
            for (char clChar : clChars) {
                String str = String.valueOf(clChar);
                // 如果字符是中文,则将中文转为汉语拼音,并取第一个字母
                if (str.matches(&quot;[\u4e00-\u9fa5]+&quot;)) {
                    hanyupinyin.append(PinyinHelper.toHanyuPinyinStringArray(
                            clChar, defaultFormat)[0]);
                    // 如果字符是数字,取数字
                } else if (str.matches(&quot;[0-9]+&quot;)) {
                    // 如果字符是字母,取字母
                    hanyupinyin.append(clChar);
                } else if (str.matches(&quot;[a-zA-Z]+&quot;)) {
                    hanyupinyin.append(clChar);
                }
            }
        } catch (BadHanyuPinyinOutputFormatCombination e) {
            System.out.println(&quot;字符不能转成汉语拼音&quot;);
        }
        return hanyupinyin.toString();
    }

    /**
     * 取第一个汉字的第一个字符
     */
    public static String getFirstLetter(String chineseLanguage) {
        char[] clChars = chineseLanguage.trim().toCharArray();
        String hanyupinyin = &quot;&quot;;
        HanyuPinyinOutputFormat defaultFormat = new HanyuPinyinOutputFormat();
        // 输出拼音全部大写
        defaultFormat.setCaseType(HanyuPinyinCaseType.UPPERCASE);
        // 不带声调
        defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);
        try {
            String str = String.valueOf(clChars[0]);
            // 如果字符是中文,则将中文转为汉语拼音,并取第一个字母
            if (str.matches(&quot;[\u4e00-\u9fa5]+&quot;)) {
                hanyupinyin = PinyinHelper.toHanyuPinyinStringArray(
                        clChars[0], defaultFormat)[0].substring(0, 1);
                // 如果字符是数字,取数字
            } else if (str.matches(&quot;[0-9]+&quot;)) {
                hanyupinyin += clChars[0];
                // 如果字符是字母,取字母
            } else if (str.matches(&quot;[a-zA-Z]+&quot;)) {
                hanyupinyin += clChars[0];
            }
        } catch (BadHanyuPinyinOutputFormatCombination e) {
            System.out.println(&quot;字符不能转成汉语拼音&quot;);
        }
        return hanyupinyin;
    }

//    public static void main(String[] args) {
//        ChineseToPinyinUtil hanyuPinyinHelper = new ChineseToPinyinUtil();
//        String city = ChineseToPinyinUtil.toHanyuPinyin(&quot;深圳市&quot;);
//        String string = &quot;shenzhen&quot;;
//        if (city.contains(string)) {
//            System.out.println(&quot;OK&quot;);
//        }
//    }
}
</code></pre>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/12/16/java/Java 实现中文-拼音转换/" data-id="cjfeor721000mw5h21ebbdlfg" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-Quartz/自定义Quartz超实用工具类" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/17/Quartz/自定义Quartz超实用工具类/">自定义Quartz超实用工具类</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/17/Quartz/自定义Quartz超实用工具类/">
            <time datetime="2017-11-17T03:09:37.000Z" itemprop="datePublished">2017-11-17</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Quartz/">Quartz</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Quartz/">Quartz</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="自定义Quartz超实用工具类"><a href="#自定义Quartz超实用工具类" class="headerlink" title="自定义Quartz超实用工具类"></a>自定义Quartz超实用工具类</h1><h2 id="1-添加maven依赖"><a href="#1-添加maven依赖" class="headerlink" title="1.添加maven依赖"></a>1.添加maven依赖</h2><pre><code> &lt;!-- https://mvnrepository.com/artifact/org.quartz-scheduler/quartz --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt;
  &lt;artifactId&gt;quartz&lt;/artifactId&gt;
  &lt;version&gt;${quartz.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><h2 id="2-实现Quartz实用工具类"><a href="#2-实现Quartz实用工具类" class="headerlink" title="2.实现Quartz实用工具类"></a>2.实现Quartz实用工具类</h2><pre><code>/**
 * Quartz任务调度器工具类
 *
 * @author CatalpaFlat
 * @date Create in 10:25 2017/11/16
 */
public class QuartzUtil {
    /**
     * 调度器工厂
     */
    private static SchedulerFactory schedulerFactory = new StdSchedulerFactory();
    /**
     * 默认Job组名
     */
    private static String JOB_GROUP_NAME = &quot;DEFAULT_JOB_GROUP_NAME&quot;;
    /**
     * 默认触发器组名
     */
    private static String TRIGGER_GROUP_NAME = &quot;DEFAULT_TRIGGER_GROUP_NAME&quot;;

    /**
     * 获取调度器
     *
     * @return Scheduler
     * @throws SchedulerException Scheduler获取异常
     */
    private static Scheduler getScheduler() throws SchedulerException {
        return schedulerFactory.getScheduler();
    }

    /**
     * 获取CronTrigger
     *
     * @param jobName          任务名
     * @param triggerGroupName 触发器组名（为空使用默认）
     * @param time             crond格式时间
     * @return CronTrigger
     */
    private static CronTrigger getCronTrigger(String jobName, String triggerGroupName, String time) {
        if (StringUtils.isBlank(triggerGroupName)) {
            triggerGroupName = TRIGGER_GROUP_NAME;
        }
        return TriggerBuilder.newTrigger().withIdentity(jobName, triggerGroupName)
                .withSchedule(CronScheduleBuilder.cronSchedule(time)).build();
    }

    /**
     * 获取JobDetail
     *
     * @param jobName      任务名
     * @param jobGroupName 任务组名（为空使用默认）
     * @param cls          任务类
     * @param jobDataMap   附带参数
     * @return JobDetail
     */
    private static JobDetail getJobDetail(String jobName, String jobGroupName, Class&lt;? extends Job&gt; cls, JobDataMap jobDataMap) {
        if (StringUtils.isBlank(jobGroupName)) {
            jobGroupName = JOB_GROUP_NAME;
        }

        if (jobDataMap != null) {
            return JobBuilder.newJob(cls).withIdentity(jobName, jobGroupName).usingJobData(jobDataMap).build();
        } else {
            return JobBuilder.newJob(cls).withIdentity(jobName, jobGroupName).build();
        }
    }

    /**
     * 设置JobDetail 和 CronTrigger 到 scheduler（已获取的调度器中，无需重复调用）
     *
     * @param cls              任务嘞
     * @param jobName          任务名
     * @param jobGroupName     任务组名（为空使用默认）
     * @param triggerGroupName 触发器组名（为空使用默认）
     * @param time             crond格式时间
     * @param jobDataMap       附带参数
     * @param scheduler        调度器
     * @return 设置成功与否
     * @throws SchedulerException 调度器异常
     */
    private static boolean setJobDetailAndCronTriggerInScheduler(Class&lt;? extends Job&gt; cls, String jobName, String jobGroupName, String triggerGroupName,
                                                                 String time, JobDataMap jobDataMap, Scheduler scheduler) throws SchedulerException {
        if (!isJobKey(scheduler, jobName, jobGroupName)) {
            return false;
        }
        JobDetail jobDetail = getJobDetail(jobName, jobGroupName, cls, jobDataMap);
        CronTrigger trigger = getCronTrigger(jobName, triggerGroupName, time);
        scheduler.scheduleJob(jobDetail, trigger);
        if (!scheduler.isShutdown()) {
            scheduler.start();
        }
        return true;
    }

    /**
     * 从调度器中移除Job
     *
     * @param scheduler  调度器
     * @param triggerKey 触发器key（名，组）
     * @param jobKey     任务key（名，组）
     */
    private static void removeJob(Scheduler scheduler, TriggerKey triggerKey, JobKey jobKey) {
        try {
            // 停止触发器
            scheduler.pauseTrigger(triggerKey);
            //移除触发器
            scheduler.unscheduleJob(triggerKey);
            // 删除任务
            scheduler.deleteJob(jobKey);
        } catch (SchedulerException e) {
            e.printStackTrace();
        }
    }

    /**
     * 使用CronTrigger类型添加任务
     *
     * @param scheduler        调度器
     * @param cls              任务嘞
     * @param jobName          任务名
     * @param jobGroupName     任务组名（为空使用默认）
     * @param triggerGroupName 触发器组名（为空使用默认）
     * @param time             crond格式时间
     * @param jobDataMap       附带参数
     * @return 是否添加成功
     */
    private static boolean addJobByCronTrigger(Scheduler scheduler, Class&lt;? extends Job&gt; cls, String jobName, String jobGroupName,
                                               String triggerGroupName, String time, JobDataMap jobDataMap) {
        try {
            return setJobDetailAndCronTriggerInScheduler(cls, jobName, jobGroupName, triggerGroupName, time, jobDataMap, scheduler);
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 判断是否存在JobKey
     *
     * @param scheduler    任务调度器
     * @param jobName      任务名
     * @param jobGroupName 任务组名
     * @return 是否存在JobKey
     */
    private static boolean isJobKey(Scheduler scheduler, String jobName, String jobGroupName) {
        JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);
        try {
            JobDetail jobDetail = scheduler.getJobDetail(jobKey);
            return jobDetail == null;
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 添加定时任务
     *
     * @param cls              任务类
     * @param jobName          任务名
     * @param jobGroupName     任务组名（为空使用默认）
     * @param triggerGroupName 触发器组名（为空使用默认）
     * @param time             crond格式时间
     * @param jobDataMap       附带参数
     * @return 是否正常添加任务
     */
    public static boolean addJobByCronTrigger(Class&lt;? extends Job&gt; cls, String jobName, String jobGroupName,
                                              String triggerGroupName, String time, JobDataMap jobDataMap) {
        try {
            if (StringUtils.isBlank(jobName)) {
                return false;
            }
            Scheduler scheduler = getScheduler();
            return setJobDetailAndCronTriggerInScheduler(cls, jobName, jobGroupName, triggerGroupName, time, jobDataMap, scheduler);
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 修改任务时间
     *
     * @param jobName          任务名
     * @param time             crond格式时间
     * @param jobGroupName     任务组名（为空使用默认）
     * @param triggerGroupName 触发器组名（为空使用默认）
     * @param jobDataMap       附带参数
     * @return 是否修改成功
     */
    public static boolean modifyJobTime(String jobName, String time, String jobGroupName,
                                        String triggerGroupName, JobDataMap jobDataMap) {
        try {
            if (StringUtils.isBlank(jobName)) {
                return false;
            }
            Scheduler scheduler = getScheduler();
            if (StringUtils.isBlank(triggerGroupName)) {
                triggerGroupName = TRIGGER_GROUP_NAME;
            }
            TriggerKey triggerKey = TriggerKey.triggerKey(jobName, triggerGroupName);
            CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);
            if (trigger == null) {
                return false;
            }
            String oldTime = trigger.getCronExpression();
            if (!oldTime.equalsIgnoreCase(time)) {
                if (StringUtils.isBlank(jobGroupName)) {
                    jobGroupName = JOB_GROUP_NAME;
                }
                JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);
                JobDetail jobDetail = scheduler.getJobDetail(jobKey);
                Class&lt;? extends Job&gt; jobClass = jobDetail.getJobClass();
                removeJob(scheduler, triggerKey, jobKey);
                return addJobByCronTrigger(scheduler, jobClass, jobName, jobGroupName, triggerGroupName, time, jobDataMap);
            }
            return true;
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 启动所有定时任务
     */
    public static void startJobs() {
        try {
            Scheduler scheduler = getScheduler();
            scheduler.start();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    /**
     * 关闭所有定时任务
     */
    public static void shutdownJobs() {
        try {
            Scheduler scheduler = getScheduler();
            if (!scheduler.isShutdown()) {
                scheduler.shutdown();
            }
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    /**
     * 停止一个job任务
     *
     * @param jobName      任务名
     * @param jobGroupName 任务组名（空位默认）
     * @return 是否停止
     */
    public static boolean pauseJob(String jobName, String jobGroupName) {
        try {
            Scheduler scheduler = getScheduler();
            if (StringUtils.isBlank(jobGroupName)) {
                jobGroupName = JOB_GROUP_NAME;
            }
            scheduler.interrupt(JobKey.jobKey(jobName, jobGroupName));
            return true;
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 恢复一个job任务
     *
     * @param jobName      任务名
     * @param jobGroupName 任务组名（空位默认）
     * @return 是否恢复
     */
    public static boolean resumeJob(String jobName, String jobGroupName) {
        try {
            Scheduler scheduler = getScheduler();
            scheduler.resumeJob(JobKey.jobKey(jobName, jobGroupName));
            return true;
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 添加定时任务
     *
     * @param cls  任务类
     * @param bJob 任务类属性
     * @return 是否添加成功
     */
    public static boolean addJobByCronTrigger(Class&lt;? extends Job&gt; cls, BaseJob bJob) {
        if (bJob == null) {
            return false;
        }
        String jobName = bJob.getJobName();
        if (StringUtils.isBlank(jobName)) {
            return false;
        }
        try {
            Scheduler scheduler = getScheduler();
            return setJobDetailAndCronTriggerInScheduler(cls, jobName, bJob.getJobGroupName(), bJob.getTriggerGroupName(), bJob.getCronTime(), bJob.getJobDataMap(), scheduler);
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }

    /**
     * 修改任务JobDateMap
     *
     * @param cls  任务类
     * @param bJob 任务类属性
     * @return 是否修改成功
     */
    public static boolean modifyJobDateMap(Class&lt;? extends Job&gt; cls, BaseJob bJob) {
        if (bJob == null) {
            return false;
        }
        String jobName = bJob.getJobName();
        if (StringUtils.isBlank(jobName)) {
            return false;
        }
        String triggerGroupName = bJob.getTriggerGroupName();
        if (StringUtils.isBlank(triggerGroupName)) {
            triggerGroupName = TRIGGER_GROUP_NAME;
        }
        TriggerKey triggerKey = TriggerKey.triggerKey(jobName, triggerGroupName);
        String jobGroupName = bJob.getJobGroupName();
        if (StringUtils.isBlank(jobGroupName)) {
            jobGroupName = JOB_GROUP_NAME;
        }
        try {
            Scheduler scheduler = getScheduler();
            JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);
            JobDetail jobDetail1 = scheduler.getJobDetail(jobKey);
            if (jobDetail1 == null) {
                return false;
            }
            JobDataMap oldJobDataMap = jobDetail1.getJobDataMap();
            JobDataMap jobDataMap = bJob.getJobDataMap();
            if (!oldJobDataMap.equals(jobDataMap)) {
                Class&lt;? extends Job&gt; jobClass = jobDetail1.getJobClass();
                removeJob(scheduler, triggerKey, jobKey);
                return addJobByCronTrigger(scheduler, jobClass, jobName, jobGroupName, triggerGroupName, bJob.getCronTime(), jobDataMap);
            }
            return true;
        } catch (SchedulerException e) {
            e.printStackTrace();
            return false;
        }
    }
}
</code></pre>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/11/17/Quartz/自定义Quartz超实用工具类/" data-id="cjfeor71y000jw5h2r3nb8hum" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-Quartz/深入解读Quartz任务调度器" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/15/Quartz/深入解读Quartz任务调度器/">深入解读Quartz任务调度器</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/15/Quartz/深入解读Quartz任务调度器/">
            <time datetime="2017-11-15T09:24:17.000Z" itemprop="datePublished">2017-11-15</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Quartz/">Quartz</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Quartz/">Quartz</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="深入解读Quartz任务调度器"><a href="#深入解读Quartz任务调度器" class="headerlink" title="深入解读Quartz任务调度器"></a>深入解读Quartz任务调度器</h1><h2 id="1-Quartz简介"><a href="#1-Quartz简介" class="headerlink" title="1.Quartz简介"></a>1.Quartz简介</h2><h3 id="1-1-概要"><a href="#1-1-概要" class="headerlink" title="1.1.概要"></a>1.1.概要</h3><p>　　Quartz是OpenSymphony提供的强大的开源任务调度框架。　　<br>　　官网：<a href="http://www.quartz-scheduler.org" target="_blank" rel="noopener">http://www.quartz-scheduler.org</a><br>　　纯Java实现，精细控制排程。<br><img src="https://i.imgur.com/MB8dnAN.png" alt=""></p>
<h3 id="1-2-Quartz特点"><a href="#1-2-Quartz特点" class="headerlink" title="1.2.Quartz特点"></a>1.2.Quartz特点</h3><ol>
<li>强大的调度能力</li>
<li>灵活的应用方式</li>
<li>强大的分布式和集群能力<h3 id="1-3-Quartz设计模式"><a href="#1-3-Quartz设计模式" class="headerlink" title="1.3.Quartz设计模式"></a>1.3.Quartz设计模式</h3></li>
</ol>
<ul>
<li>Builder模式</li>
<li>组件模式</li>
<li>Factory模式</li>
<li>链式写法<h3 id="1-4-Quartz体系结构"><a href="#1-4-Quartz体系结构" class="headerlink" title="1.4.Quartz体系结构"></a>1.4.Quartz体系结构</h3><h4 id="1-4-1-三大核心"><a href="#1-4-1-三大核心" class="headerlink" title="1.4.1.三大核心"></a>1.4.1.三大核心</h4></li>
<li>调度器</li>
<li>任务</li>
<li>触发器 </li>
</ul>
<p><img src="https://i.imgur.com/mAHuNjM.jpg" alt=""></p>
<h4 id="1-4-2-重要组成"><a href="#1-4-2-重要组成" class="headerlink" title="1.4.2.重要组成"></a>1.4.2.重要组成</h4><p>1）任务： </p>
<ul>
<li><p>Job：表示一个工作，要执行的具体内容。此接口中只有一个方法。要创建一个任务，必须得实现这个接口。该接口只有一个execute方法，任务每次被调用的时候都会执行这个execute方法的逻辑，类似TimerTask的run方法，在里面编写业务逻辑。 </p>
<pre><code>public class TestJob implements Job {
    /**把要执行的操作，写在execute方法中  */
    @Override
    public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {
        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm:ss&quot;);
        System.out.println(&quot;I can do something...&quot;);
        System.out.println(sdf.format(new Date()));
    }
}
</code></pre></li>
</ul>
<p>生命周期：在每次调度器执行job时，它在调用execute方法前会创建一个新的job实例，当调用完成之后，关联的job对象实例会被释放，释放的实例会被垃圾回收机制回收。</p>
<ul>
<li><p>JobBuilder：可向任务传递数据,通常情况下,我们使用它就可向任务类发送数据了，如有特别复杂的传递参数,它提供了一个传递递:JobDataMap对象的方法　　</p>
<pre><code>JobDetail jobDetail =  JobBuilder.newJob(TestJob.class).withIdentity(&quot;testJob&quot;,&quot;group1&quot;).build();
</code></pre></li>
<li><p>JobDetail：用来保存我们任务的详细信息。一个JobDetail可以有多个Trigger，但是一个Trigger只能对应一个JobDetail。下面是JobDetail的一些常用的属性和含义：　　</p>
</li>
</ul>
<p>　　<img src="https://i.imgur.com/aid7mV3.png" alt=""></p>
<ul>
<li><p>JobStore：负责跟踪所有你给scheduler的“工作数据”：jobs, triggers, calendars, 等。</p>
<ul>
<li><p>RAMJobStore：是使用最简单的也是最高效(依据CPU时间)的JobStore 。RAMJobStore 正如它名字描述的一样，它保存数据在RAM。缺点是你的应用结束之后所有的数据也丢失了–这意味着RAMJobStore 不具有保持job和trigger持久的能力。对于一些程序是可以接受的，甚至是期望的，但对于其他的程序可能是灾难性的。使用RAMJobStore配置Quartz：配置如下</p>
<pre><code>org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore 
</code></pre></li>
<li><p>JDBCJobStore：以JDBC的方式保存数据在数据库中。它比RAMJobStore的配置复杂一点，也没有RAMJobStore快。然而,性能缺点不是糟透了,特别是如果你在数据库表主键上建立了索引。在机器之间的LAN(在scheduler 和数据库之间)合理的情况下，检索和更新一个被触发的Trigger花费的时间少于10毫秒。几乎适用于所有的数据库，广泛用于 Oracle。PostgreSQL, MySQL, MS SQLServer, HSQLDB, 和DB2。使用JDBCJobStore之前你必须首先创建一系列Quartz要使用的表。你可以发现表创建语句在Quartz发布目录的 “docs/dbTables”下面。你需要确定你的应用要使用的事务类型。如果你不想绑定调度命令(例如增加和移除Trigger)到其他的事务，你可以使用JobStoreTX (最常用的选择)作为你的Jobstore。如果你需要Quartz和其他的事务(例如在J2EE应用服务器中)一起工作，你应该使用JobStoreCMT ，Quartz 将让应用服务器容器管理这个事务。使用JobStoreTx配置Quartz：</p>
<pre><code>org.quartz.jobStore.class = org.quartz.impl.jdbcjobstore.JobStoreTX  
org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate  
#配置表的前缀  
org.quartz.jobStore.tablePrefix = QRTZ_  
#使用JNDI数据源的时候，数据源的名字  
org.quartz.jobStore.dataSource = myDS      
</code></pre></li>
<li><p>TerracottaJobStore：提供了一个方法：在不使用数据库的情况下使它具有收缩性和强壮性。可以是集群的也可以是非集群的，在这两种情况下为你的job数据提供了一个存储机制用于应用程序重启之间持久,因为数据是存储在Terracotta服务器。它的性能比使用数据库访问JDBCJobStore好一点儿(大约是一个数量级)，但是明显比RAMJobStore慢。使用TerracottaJobStore配置Quartz：</p>
<pre><code>org.quartz.jobStore.class = org.terracotta.quartz.TerracottaJobStore  
org.quartz.jobStore.tcConfigUrl = localhost:9510  
</code></pre></li>
</ul>
</li>
<li><p>JobDataMap：中可以包含不限量的（序列化的）数据对象，在job实例执行的时候，可以使用其中的数据；JobDataMap是Java Map接口的一个实现，额外增加了一些便于存取基本类型的数据的方法。</p>
<ul>
<li><p>存：</p>
<pre><code>JobDetail jobDetail =  JobBuilder.newJob(TestJob.class).withIdentity(&quot;testJob&quot;,&quot;group1&quot;).usingJobData(&quot;date1&quot;,&quot;存内容&quot;).build(); 
</code></pre></li>
<li><p>取：</p>
<pre><code>public class TestJob implements Job {
    /**把要执行的操作，写在execute方法中  */
    @Override
    public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {
        JobKey key = jobExecutionContext.getJobDetail().getKey();
        JobDataMap jobDataMap = jobExecutionContext.getJobDetail().getJobDataMap();
        String date1 = jobDataMap.getString(&quot;date1&quot;);
    }
}
</code></pre></li>
</ul>
</li>
</ul>
<hr>
<p>2）触发器：用来触发执行Job<br><img src="https://i.imgur.com/Bg3Bxud.png" alt="">  </p>
<p>2.1）触发器通用属性： </p>
<ul>
<li>Jobkey：表示job实例的标识，触发器被触发时，该指定的job实例会被执行</li>
<li>StartTime：表示触发器的时间表首次被触发的时间，它的值类型为：java.util.Date</li>
<li>EndTime：指定触发器的不再被触发的时间，它的值类型为：java.util.Date</li>
</ul>
<p>2.2）触发器类型：</p>
<ul>
<li><p>SimpleTrigger： 主要是针对一些相对简单的时间触发进行配置使用，比如在指定的时间开始然后在一定的时间间隔之内重复执行一个Job，同时可以任意指定重复的次数。下面就是使用一个SimpleTrigger的例子:  </p>
<pre><code>//创建触发器 每3秒钟执行一次(无开始时间和结束时间)
Trigger trigger = TriggerBuilder.newTrigger()
            .withIdentity(&quot;trigger1&quot;, &quot;group3&quot;)
            .withSchedule(
            SimpleScheduleBuilder.simpleSchedule()
            .withIntervalInSeconds(3).repeatForever()).build();
//创建触发器 每3秒钟执行一次(有开始时间和结束时间)
 long now = new Date().getTime();
Date start = new Date(now+6000);
Date end = new Date(now+12000);
//创建触发器 每3秒钟执行一次
Trigger trigger = TriggerBuilder.newTrigger()
                  .withIdentity(&quot;trigger1&quot;, &quot;group3&quot;)
                  .startAt(start)
                  .endAt(end)
                  .withSchedule(SimpleScheduleBuilder.simpleSchedule().withIntervalInSeconds(3).repeatForever()).build();
</code></pre><p>SimpleTrigger具有丰富的构造函数，根据业务需求构造不同的构造函数。</p>
</li>
<li><p>CronTrigger： 可以配置更复杂的触发时刻表，基于日历的作业触发器，而不像SimpleTrigger那样精确指定间隔时间，比SimpleTrigger更加常用。  </p>
</li>
</ul>
<p>　　Cron表达式：用于配置CronTrigger实例，是由7个表达式组成的字符串，描述了时间表的详细信息。<br>　　格式为：[秒][分][时][日][月][周][年]<br>　　Cron表达式特殊字符意义对应表：<br>　　<img src="https://i.imgur.com/spUTIoo.png" alt=""><br>　　通配符说明：<br>　　<img src="https://i.imgur.com/lkq9yso.png" alt=""><br>　　Cron表达式例子：<br>　　<img src="https://i.imgur.com/SOh7Ujr.png" alt=""></p>
<pre><code>TriggerBuilder.newTrigger().withIdentity(&quot;trigger2&quot;,&quot;group2&quot;)
            .withSchedule(CronScheduleBuilder.cronSchedule(&quot;0 0 9 ? * 6L *&quot;)).build();
</code></pre><p>　　Cron表达式小技巧：<br>　　1. ‘L’和‘W’可以一起组合使用<br>　　2. 周字段英文字母不区分大小写即MOM与mom相同<br>　　3. 利用工具，在线生成cron表达式：<a href="http://cron.qqe2.com/" target="_blank" rel="noopener">http://cron.qqe2.com/</a>  </p>
<ul>
<li><p>NthIncludedDayTrigger：是 Quartz 开发团队最新加入到框架中的一个 Trigger。它设计用于在每一间隔类型的第几天执行 Job。例如，你要在每个月的 15 号执行开票的 Job，用 NthIncludedDayTrigger就再合适不过了。</p>
<pre><code>NthIncludedDayTrigger trigger = new NthIncludedDayTrigger(&quot;NthIncludedDayTrigger&quot;,Scheduler.DEFAULT_GROUP);
            trigger.setN(15);
            trigger.setIntervalType(NthIncludedDayTrigger.INTERVAL_TYPE_MONTHLY);
</code></pre></li>
</ul>
<hr>
<p>3）调度器Scheduler<br>　　代表一个Quartz的独立运行容器，Trigger和JobDetail可以注册到Scheduler中，两者在Scheduler中拥有各自的组及名称，组及名称是Scheduler查找定位容器中某一对象的依据，Trigger的组及名称必须唯一，JobDetail的组和名称也必须唯一（但可以和Trigger的组和名称相同，因为它们是不同类型的）。Scheduler定义了多个接口方法，允许外部通过组及名称访问和控制容器中Trigger和JobDetail。<br>　　Scheduler可以将Trigger绑定到某一JobDetail中，这样当Trigger触发时，对应的Job就被执行。一个Job可以对应多个Trigger，但一个Trigger只能对应一个Job。<br>　　可以通过SchedulerFactory创建一个Scheduler实例。Scheduler拥有一个SchedulerContext，它类似于ServletContext，保存着Scheduler上下文信息，Job和Trigger都可以访问SchedulerContext内的信息。SchedulerContext内部通过一个Map，以键值对的方式维护这些上下文数据，SchedulerContext为保存和获取数据提供了多个put()和getXxx()的方法。可以通过Scheduler# getContext()获取对应的SchedulerContext实例；  </p>
<pre><code>SchedulerFactory schedulerfactory=new StdSchedulerFactory();
Scheduler scheduler = schedulerfactory.getScheduler();

 DirectSchedulerFactory factory = DirectSchedulerFactory.getInstance();
try {
    Scheduler scheduler = factory.getScheduler();
} catch (SchedulerException e) {
    e.printStackTrace();
}
</code></pre><hr>
<p>4)SchedulerFactory:  </p>
<ul>
<li>使用一组参数（java.util.Properties）来创建和出书啊Quartz调度器</li>
<li>配置参数一般存储在quartz.properties中</li>
<li>调用getScheduler方法就能创建和初始化调度器</li>
</ul>
<hr>
<p>5)quartz.properties:<br>Quartz-Job的quartz.properties配置文件说明，此文件在quartz的jar包有，可直接拿过来使用不过只有基本的几个配置 自己可根据需要进行扩充；另外如果项目中没有对该配置文件重写，则Quartz会加载自己jar包中的quartz.properties文件。  </p>
<pre><code># Default Properties file for use by StdSchedulerFactory  
# to create a Quartz Scheduler Instance, if a different  
# properties file is not explicitly specified.  
#  
# ===========================================================================  
# Configure Main Scheduler Properties 调度器属性  
# ===========================================================================  
org.quartz.scheduler.instanceName: DefaultQuartzScheduler  
#org.quartz.scheduler.instanceid:AUTO  
org.quartz.scheduler.rmi.export: false  
org.quartz.scheduler.rmi.proxy: false  
org.quartz.scheduler.wrapJobExecutionInUserTransaction: false  
# ===========================================================================    
# Configure ThreadPool 线程池属性    
# ===========================================================================  
#线程池的实现类（一般使用SimpleThreadPool即可满足几乎所有用户的需求）  
org.quartz.threadPool.class: org.quartz.simpl.SimpleThreadPool  
#指定线程数，至少为1（无默认值）(一般设置为1-100直接的整数合适)  
org.quartz.threadPool.threadCount: 10  
#设置线程的优先级（最大为java.lang.Thread.MAX_PRIORITY 10，最小为Thread.MIN_PRIORITY 1，默认为5）  
org.quartz.threadPool.threadPriority: 5  
#设置SimpleThreadPool的一些属性  
#设置是否为守护线程  
#org.quartz.threadpool.makethreadsdaemons = false  
#org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread: true  
#org.quartz.threadpool.threadsinheritgroupofinitializingthread=false  
#线程前缀默认值是：[Scheduler Name]_Worker  
#org.quartz.threadpool.threadnameprefix=swhJobThead;  
# 配置全局监听(TriggerListener,JobListener) 则应用程序可以接收和执行 预定的事件通知  
# ===========================================================================  
# Configuring a Global TriggerListener 配置全局的Trigger监听器  
# MyTriggerListenerClass 类必须有一个无参数的构造函数，和 属性的set方法，目前2.2.x只支持原始数据类型的值（包括字符串）  
# ===========================================================================  
#org.quartz.triggerListener.NAME.class = com.swh.MyTriggerListenerClass  
#org.quartz.triggerListener.NAME.propName = propValue  
#org.quartz.triggerListener.NAME.prop2Name = prop2Value  
# ===========================================================================  
# Configuring a Global JobListener 配置全局的Job监听器  
# MyJobListenerClass 类必须有一个无参数的构造函数，和 属性的set方法，目前2.2.x只支持原始数据类型的值（包括字符串）  
# ===========================================================================  
#org.quartz.jobListener.NAME.class = com.swh.MyJobListenerClass  
#org.quartz.jobListener.NAME.propName = propValue  
#org.quartz.jobListener.NAME.prop2Name = prop2Value  
# ===========================================================================    
# Configure JobStore 存储调度信息（工作，触发器和日历等）  
# ===========================================================================  
# 信息保存时间 默认值60秒  
org.quartz.jobStore.misfireThreshold: 60000  
#保存job和Trigger的状态信息到内存中的类  
org.quartz.jobStore.class: org.quartz.simpl.RAMJobStore  
# ===========================================================================    
# Configure SchedulerPlugins 插件属性 配置  
# ===========================================================================  
# 自定义插件    
#org.quartz.plugin.NAME.class = com.swh.MyPluginClass  
#org.quartz.plugin.NAME.propName = propValue  
#org.quartz.plugin.NAME.prop2Name = prop2Value  
#配置trigger执行历史日志（可以看到类的文档和参数列表）  
org.quartz.plugin.triggHistory.class = org.quartz.plugins.history.LoggingTriggerHistoryPlugin    
org.quartz.plugin.triggHistory.triggerFiredMessage = Trigger {1}.{0} fired job {6}.{5} at: {4, date, HH:mm:ss MM/dd/yyyy}    
org.quartz.plugin.triggHistory.triggerCompleteMessage = Trigger {1}.{0} completed firing job {6}.{5} at {4, date, HH:mm:ss MM/dd/yyyy} with resulting trigger instruction code: {9}    
#配置job调度插件  quartz_jobs(jobs and triggers内容)的XML文档    
#加载 Job 和 Trigger 信息的类   （1.8之前用：org.quartz.plugins.xml.JobInitializationPlugin）  
org.quartz.plugin.jobInitializer.class = org.quartz.plugins.xml.XMLSchedulingDataProcessorPlugin  
#指定存放调度器(Job 和 Trigger)信息的xml文件，默认是classpath下quartz_jobs.xml  
org.quartz.plugin.jobInitializer.fileNames = my_quartz_job2.xml    
#org.quartz.plugin.jobInitializer.overWriteExistingJobs = false    
org.quartz.plugin.jobInitializer.failOnFileNotFound = true    
#自动扫描任务单并发现改动的时间间隔,单位为秒  
org.quartz.plugin.jobInitializer.scanInterval = 10  
#覆盖任务调度器中同名的jobDetail,避免只修改了CronExpression所造成的不能重新生效情况  
org.quartz.plugin.jobInitializer.wrapInUserTransaction = false  
# ===========================================================================    
# Sample configuration of ShutdownHookPlugin  ShutdownHookPlugin插件的配置样例  
# ===========================================================================  
#org.quartz.plugin.shutdownhook.class = \org.quartz.plugins.management.ShutdownHookPlugin  
#org.quartz.plugin.shutdownhook.cleanShutdown = true  
#  
# Configure RMI Settings 远程服务调用配置  
#  
#如果你想quartz-scheduler出口本身通过RMI作为服务器，然后设置“出口”标志true(默认值为false)。  
#org.quartz.scheduler.rmi.export = false  
#主机上rmi注册表(默认值localhost)  
#org.quartz.scheduler.rmi.registryhost = localhost  
#注册监听端口号（默认值1099）  
#org.quartz.scheduler.rmi.registryport = 1099  
#创建rmi注册，false/never：如果你已经有一个在运行或不想进行创建注册  
# true/as_needed:第一次尝试使用现有的注册，然后再回来进行创建  
# always:先进行创建一个注册，然后再使用回来使用注册  
#org.quartz.scheduler.rmi.createregistry = never  
#Quartz Scheduler服务端端口，默认是随机分配RMI注册表  
#org.quartz.scheduler.rmi.serverport = 1098  
#true:链接远程服务调度(客户端),这个也要指定registryhost和registryport，默认为false  
# 如果export和proxy同时指定为true，则export的设置将被忽略  
#org.quartz.scheduler.rmi.proxy = false  
</code></pre>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/11/15/Quartz/深入解读Quartz任务调度器/" data-id="cjfeor71i0008w5h2klkyf1lg" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-消息队列/RabbitMQ" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/11/消息队列/RabbitMQ/">消息队列之RabbitMQ</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/11/消息队列/RabbitMQ/">
            <time datetime="2017-11-11T08:08:34.000Z" itemprop="datePublished">2017-11-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/消息队列/">消息队列</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/消息队列/">消息队列</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h1><h3 id="1-RabbitMQ概述"><a href="#1-RabbitMQ概述" class="headerlink" title="1.RabbitMQ概述"></a>1.RabbitMQ概述</h3><p>&emsp;&emsp;MQ全称为Message Queue, 消息队列（MQ）是一种应用程序对应用程序的通信方法。应用程序通过读写出入队列的消息（针对应用程序的数据）来通信，而无需专用连接来链接它们。消息传递指的是程序之间通过在消息中发送数据进行通信，而不是通过直接调用彼此来通信，直接调用通常是用于诸如远程过程调用的技术。排队指的是应用程序通过 队列来通信。队列的使用除去了接收和发送应用程序同时执行的要求。其中较为成熟的MQ产品有IBM WEBSPHERE MQ等等。</p>
<h3 id="2-RabbitMQ安装"><a href="#2-RabbitMQ安装" class="headerlink" title="2.RabbitMQ安装"></a>2.RabbitMQ安装</h3><p>Windows环境下：<br>RabbitMQ基于erlang，因此先安装erlang<br>2.1 安装erlang<br>2.1.1 下载并安装erlang<br>erlang下载地址：<a href="http://www.erlang.org/downloads" target="_blank" rel="noopener">http://www.erlang.org/downloads</a><br>erlang安装过程直接一直next到底<br>2.1.2 设置erlang环境变量<br><img src="https://i.imgur.com/IsFZU83.png" alt=""><br>将;%ERLANG_HOME%\bin添加到Path<br>2.1.3 测试erlang是否安装成功<br><img src="https://i.imgur.com/qJAIMRT.png" alt=""><br>2.2 安装RabbitMQ<br>2.2.1 下载并安装RabbitMQ<br>RabbitMQ下载地址：<a href="http://www.rabbitmq.com/install-windows.html" target="_blank" rel="noopener">http://www.rabbitmq.com/install-windows.html</a><br>RabbitMQ安装过程也一直next到底<br>2.2.2 激活 RabbitMQ’s Management Plugin<br>到RabbitMQ的安装目录找到<br>E:\RabbitMQServer\rabbitmq_server-3.6.5\sbin\<br>运行rabbitmq-plugins enable rabbitmq_management<br><img src="https://i.imgur.com/S8Q6YoD.png" alt=""><br>接着直接重启服务<br>rabbitmq-service stop<br><img src="https://i.imgur.com/TgZPpm6.png" alt=""><br>rabbitmq-service start<br><img src="https://i.imgur.com/Qe0CTzI.png" alt=""><br>2.2.3 浏览器访问<a href="http://localhost:15672/#/" target="_blank" rel="noopener">http://localhost:15672/#/</a><br>使用账号：guest密码：guest登录即可<br><img src="https://i.imgur.com/FbJtEqA.png" alt=""><br>自此RabbitMQ安装完毕</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/11/11/消息队列/RabbitMQ/" data-id="cjfeor72o001xw5h22sg5jx9q" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/Java 自定义超实用Redis工具类（满足对象，list，map等类型）" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/11/java/Java 自定义超实用Redis工具类（满足对象，list，map等类型）/">Java 自定义超实用Redis工具类（满足对象，list，map等类型）</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/11/java/Java 自定义超实用Redis工具类（满足对象，list，map等类型）/">
            <time datetime="2017-11-11T07:11:22.000Z" itemprop="datePublished">2017-11-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Java/">Java</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Java/">Java</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="自定义超实用Redis工具类（满足对象，list，map等类型）"><a href="#自定义超实用Redis工具类（满足对象，list，map等类型）" class="headerlink" title="自定义超实用Redis工具类（满足对象，list，map等类型）"></a>自定义超实用Redis工具类（满足对象，list，map等类型）</h1><p>该工具类，可以存储对象、list，map等各种数据类型到Redis中，大大有效提高开发效率。</p>
<h2 id="1-添加maven依赖"><a href="#1-添加maven依赖" class="headerlink" title="1.添加maven依赖"></a>1.添加maven依赖</h2><pre><code>&lt;!--序列化工具--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.objenesis&lt;/groupId&gt;
    &lt;artifactId&gt;objenesis&lt;/artifactId&gt;
    &lt;version&gt;${objenesis.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/com.dyuproject.protostuff/protostuff-core --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;
    &lt;artifactId&gt;protostuff-core&lt;/artifactId&gt;
    &lt;version&gt;${dyuproject.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;
    &lt;artifactId&gt;protostuff-runtime&lt;/artifactId&gt;
    &lt;version&gt;${dyuproject.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><p>注：采用序列化工具进行解析。版本如下：</p>
<pre><code>&lt;dyuproject.version&gt;1.1.3&lt;/dyuproject.version&gt;
&lt;objenesis.version&gt;2.6&lt;/objenesis.version&gt;
</code></pre><h2 id="2-序列化工具类"><a href="#2-序列化工具类" class="headerlink" title="2.序列化工具类"></a>2.序列化工具类</h2><pre><code>/**
 * 序列化工具类
 * @Author： CatalpaFlat
 * @Descrition:
 * @Date: Create in 15:04 2017/11/11
 * @Modified BY：
 */
public class ProtoStuffSerializerUtil {
    public static &lt;T&gt; byte[] serialize(T obj) {
        if (obj == null) {
            throw new RuntimeException(&quot;序列化对象(&quot; + obj + &quot;)!&quot;);
        }
        @SuppressWarnings(&quot;unchecked&quot;)
        Schema&lt;T&gt; schema = (Schema&lt;T&gt;) RuntimeSchema.getSchema(obj.getClass());
        LinkedBuffer buffer = LinkedBuffer.allocate(1024 * 1024);
        byte[] protostuff = null;
        try {
            protostuff = ProtostuffIOUtil.toByteArray(obj, schema, buffer);
        } catch (Exception e) {
            throw new RuntimeException(&quot;序列化(&quot; + obj.getClass() + &quot;)对象(&quot; + obj + &quot;)发生异常!&quot;, e);
        } finally {
            buffer.clear();
        }
        return protostuff;
    }
    public static &lt;T&gt; T deserialize(byte[] paramArrayOfByte, Class&lt;T&gt; targetClass) {
        if (paramArrayOfByte == null || paramArrayOfByte.length == 0) {
            throw new RuntimeException(&quot;反序列化对象发生异常,byte序列为空!&quot;);
        }
        T instance = null;
        try {
            // T message = objenesis.newInstance(cls);
            instance = targetClass.newInstance();
        } catch (InstantiationException | IllegalAccessException e) {
            throw new RuntimeException(&quot;反序列化过程中依据类型创建对象失败!&quot;, e);
        }
        Schema&lt;T&gt; schema = RuntimeSchema.getSchema(targetClass);
        ProtostuffIOUtil.mergeFrom(paramArrayOfByte, instance, schema);
        return instance;
    }
    public static &lt;T&gt; byte[] serializeList(List&lt;T&gt; objList) {
        if (objList == null || objList.isEmpty()) {
            throw new RuntimeException(&quot;序列化对象列表(&quot; + objList + &quot;)参数异常!&quot;);
        }
        @SuppressWarnings(&quot;unchecked&quot;)
        Schema&lt;T&gt; schema = (Schema&lt;T&gt;) RuntimeSchema.getSchema(objList.get(0).getClass());
        LinkedBuffer buffer = LinkedBuffer.allocate(1024 * 1024);
        byte[] protostuff = null;
        ByteArrayOutputStream bos = null;
        try {
            bos = new ByteArrayOutputStream();
            ProtostuffIOUtil.writeListTo(bos, objList, schema, buffer);
            protostuff = bos.toByteArray();
        } catch (Exception e) {
            throw new RuntimeException(&quot;序列化对象列表(&quot; + objList + &quot;)发生异常!&quot;, e);
        } finally {
            buffer.clear();
            try {
                if(bos!=null){
                    bos.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return protostuff;
    }
    public static &lt;T&gt; List&lt;T&gt; deserializeList(byte[] paramArrayOfByte, Class&lt;T&gt; targetClass) {
        if (paramArrayOfByte == null || paramArrayOfByte.length == 0) {
            throw new RuntimeException(&quot;反序列化对象发生异常,byte序列为空!&quot;);
        }

        Schema&lt;T&gt; schema = RuntimeSchema.getSchema(targetClass);
        List&lt;T&gt; result = null;
        try {
            result = ProtostuffIOUtil.parseListFrom(new ByteArrayInputStream(paramArrayOfByte), schema);
        } catch (IOException e) {
            throw new RuntimeException(&quot;反序列化对象列表发生异常!&quot;,e);
        }
        return result;
    }
    public static class Person{
        int id;
        String name;

        public Person(){

        }

        public Person(int id, String name){
            this.id = id;
            this.name = name;
        }

        public int getId() {
            return id;
        }
        public String getName() {
            return name;
        }

    }
}
</code></pre><h2 id="3-配置redisConfig类进行存储"><a href="#3-配置redisConfig类进行存储" class="headerlink" title="3.配置redisConfig类进行存储"></a>3.配置redisConfig类进行存储</h2><pre><code>/**
 * redis配置类
 * @Author： CatalpaFlat
 * @Descrition:
 * @Date: Create in 15:04 2017/11/11
 * @Modified BY：
 */
@Component
public class RedisConfig {

    public final static String CAHCENAME = &quot;CatalpaFlat&quot;;// 缓存名
    public final static int CAHCETIME = 60;// 默认缓存时间 60S
    public final static int CAHCEHOUR = 60 * 60;// 默认缓存时间 1hr
    public final static int CAHCEDAY = 60 * 60 * 24;// 默认缓存时间 1Day
    public final static int CAHCEWEEK = 60 * 60 * 24 * 7;// 默认缓存时间 1week
    public final static int CAHCEMONTH = 60 * 60 * 24 * 7 * 30;// 默认缓存时间 1month
    public final static int CAHCEYEAR = 60 * 60 * 24 * 7 * 30 * 12;// 默认缓存时间 1年
    @Autowired
    private RedisTemplate&lt;String, String&gt; redisTemplate;

    public &lt;T&gt; boolean putCache(String key, T obj) {
        final byte[] bkey = key.getBytes();
        final byte[] bvalue = ProtoStuffSerializerUtil.serialize(obj);
        boolean result = redisTemplate.execute((RedisCallback&lt;Boolean&gt;) connection -&gt; connection.setNX(bkey, bvalue));
        return result;
    }
    public &lt;T&gt; void putCacheWithExpireTime(String key, T obj, final long expireTime) {
        final byte[] bkey = key.getBytes();
        final byte[] bvalue = ProtoStuffSerializerUtil.serialize(obj);
        redisTemplate.execute((RedisCallback&lt;Boolean&gt;) connection -&gt; {
            connection.setEx(bkey, expireTime, bvalue);
            return true;
        });
    }
    public &lt;T&gt; boolean putListCache(String key, List&lt;T&gt; objList) {
        final byte[] bkey = key.getBytes();
        final byte[] bvalue = ProtoStuffSerializerUtil.serializeList(objList);
        boolean result = redisTemplate.execute((RedisCallback&lt;Boolean&gt;) connection -&gt; connection.setNX(bkey, bvalue));
        return result;
    }
    public &lt;T&gt; boolean putListCacheWithExpireTime(String key, List&lt;T&gt; objList, final long expireTime) {
        final byte[] bkey = key.getBytes();
        final byte[] bvalue = ProtoStuffSerializerUtil.serializeList(objList);
        boolean result = redisTemplate.execute((RedisCallback&lt;Boolean&gt;) connection -&gt; {
            connection.setEx(bkey, expireTime, bvalue);
            return true;
        });
        return result;
    }
    public &lt;T&gt; T getCache(final String key, Class&lt;T&gt; targetClass) {
        byte[] result = redisTemplate.execute(new RedisCallback&lt;byte[]&gt;() {
            @Override
            public byte[] doInRedis(RedisConnection connection) throws DataAccessException {
                return connection.get(key.getBytes());
            }
        });
        if (result == null) {
            return null;
        }
        return ProtoStuffSerializerUtil.deserialize(result, targetClass);
    }
    public &lt;T&gt; List&lt;T&gt; getListCache(final String key, Class&lt;T&gt; targetClass) {
        byte[] result = redisTemplate.execute(new RedisCallback&lt;byte[]&gt;() {
            @Override
            public byte[] doInRedis(RedisConnection connection) throws DataAccessException {
                return connection.get(key.getBytes());
            }
        });
        if (result == null) {
            return null;
        }
        return ProtoStuffSerializerUtil.deserializeList(result, targetClass);
    }
    /**
     * 精确删除key
     *
     * @param key
     */
    public void deleteCache(String key) {
        redisTemplate.delete(key);
    }

    /**
     * 模糊删除key
     *
     * @param pattern
     */
    public void deleteCacheWithPattern(String pattern) {
        Set&lt;String&gt; keys = redisTemplate.keys(pattern);
        redisTemplate.delete(keys);
    }

    /**
     * 清空所有缓存
     */
    public void clearCache() {
        deleteCacheWithPattern(RedisConfig.CAHCENAME + &quot;|*&quot;);
    }
}
</code></pre><h2 id="4-测试序列化工具类"><a href="#4-测试序列化工具类" class="headerlink" title="4.测试序列化工具类"></a>4.测试序列化工具类</h2><p>注：基于这篇文章<br><a href="http://blog.csdn.net/DuShiWoDeCuo/article/details/78506579" target="_blank" rel="noopener">http://blog.csdn.net/DuShiWoDeCuo/article/details/78506579</a><br>    /**</p>
<pre><code> * @Author： CatalpaFlat
 * @Descrition:
 * @Date: Create in 10:08 2017/11/8
 * @Modified BY：
 */
@RunWith(SpringRunner.class)
@ContextConfiguration({&quot;classpath:spring/*.xml&quot;})
public class TestRedis {

    @Resource
    private RedisConfig redisConfig;
    @Autowired(required=true)
    private RedisKeyUtil redisKeyUtil;
    @Autowired
    private RedisTemplate redisTemplate;

    private static final Logger log  = Logger.getLogger(TestRedis.class.getName());

    @Test
    public void test(){
//        redisTemplate.opsForValue().set(&quot;chen&quot;, &quot;陈梓平&quot;);
//        log.info(&quot;value：&quot;+redisTemplate.opsForValue().get(&quot;chen&quot;));
        String key = redisKeyUtil.getSystemRedisKeyDistribution(&quot;Test&quot;, this.getClass().getName(), &quot;test&quot;);
        log.info(&quot;cache-key:&quot;+key);
        redisConfig.putCache(key,&quot;测试链接&quot;);
        String cache = redisConfig.getCache(key, String.class);
        log.info(&quot;cache-value:&quot;+cache);
    }
}
</code></pre><p><img src="https://i.imgur.com/kW8Yn27.png" alt=""></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/11/11/java/Java 自定义超实用Redis工具类（满足对象，list，map等类型）/" data-id="cjfeor722000pw5h2dvanw8xt" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-nginx/Nginx配置多虚拟主机（即配置域名）" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/08/27/nginx/Nginx配置多虚拟主机（即配置域名）/">Nginx配置多虚拟主机（即配置域名）</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/08/27/nginx/Nginx配置多虚拟主机（即配置域名）/">
            <time datetime="2017-08-27T13:33:54.000Z" itemprop="datePublished">2017-08-27</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Nginx/">Nginx</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="Nginx配置多虚拟主机（即配置域名）"><a href="#Nginx配置多虚拟主机（即配置域名）" class="headerlink" title="Nginx配置多虚拟主机（即配置域名）"></a>Nginx配置多虚拟主机（即配置域名）</h1><h2 id="1-存放站点（即项目）"><a href="#1-存放站点（即项目）" class="headerlink" title="1.存放站点（即项目）"></a>1.存放站点（即项目）</h2><p>站点的根目录和域名相同</p>
<h3 id="1-1-创建a域名存放地址"><a href="#1-1-创建a域名存放地址" class="headerlink" title="1.1.创建a域名存放地址"></a>1.1.创建a域名存放地址</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/site/a.chen.com</span><br></pre></td></tr></table></figure>
<h3 id="1-2-创建a域名的首页"><a href="#1-2-创建a域名的首页" class="headerlink" title="1.2.创建a域名的首页"></a>1.2.创建a域名的首页</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /data/site/a.chen.com</span><br><span class="line">touch inde.html</span><br><span class="line">echo &apos;this is a from chen com...&apos; &gt; /data/site/a.chen.com/inde.html</span><br></pre></td></tr></table></figure>
<h3 id="1-3-创建b域名存放地址"><a href="#1-3-创建b域名存放地址" class="headerlink" title="1.3.创建b域名存放地址"></a>1.3.创建b域名存放地址</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/site/b.chen.com</span><br></pre></td></tr></table></figure>
<h3 id="1-4-创建b域名的首页"><a href="#1-4-创建b域名的首页" class="headerlink" title="1.4.创建b域名的首页"></a>1.4.创建b域名的首页</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /data/site/b.chen.com</span><br><span class="line">touch inde.html</span><br><span class="line">echo &apos;this is b from chen com...&apos; &gt; /data/site/b.chen.com/inde.html</span><br></pre></td></tr></table></figure>
<h3 id="1-5-添加日志存放目录"><a href="#1-5-添加日志存放目录" class="headerlink" title="1.5.添加日志存放目录"></a>1.5.添加日志存放目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/logs/nginx</span><br></pre></td></tr></table></figure>
<h2 id="2-配置nginx的配置文件"><a href="#2-配置nginx的配置文件" class="headerlink" title="2.配置nginx的配置文件"></a>2.配置nginx的配置文件</h2><p>（注：若还没安装nginx的话，详情请看这一篇文章</p>
<blockquote>
<p><a href="http://blog.csdn.net/dushiwodecuo/article/details/78393454）" target="_blank" rel="noopener">http://blog.csdn.net/dushiwodecuo/article/details/78393454）</a></p>
</blockquote>
<h3 id="2-1-进入nginx配置目录"><a href="#2-1-进入nginx配置目录" class="headerlink" title="2.1.进入nginx配置目录"></a>2.1.进入nginx配置目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/conf/</span><br></pre></td></tr></table></figure>
<h3 id="2-2-编辑nginx-conf"><a href="#2-2-编辑nginx-conf" class="headerlink" title="2.2.编辑nginx.conf"></a>2.2.编辑nginx.conf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim nginx.conf</span><br></pre></td></tr></table></figure>
<h4 id="2-2-1-配置nginx日志格式"><a href="#2-2-1-配置nginx日志格式" class="headerlink" title="2.2.1.配置nginx日志格式"></a>2.2.1.配置nginx日志格式</h4><p>在nginx.conf中找到如下内容，并且将#注释标志去掉<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line"># &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line"># &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-2-2-配置nginx主配置内容"><a href="#2-2-2-配置nginx主配置内容" class="headerlink" title="2.2.2.配置nginx主配置内容"></a>2.2.2.配置nginx主配置内容</h4><p>a域名服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">	server_name a.chen.com;</span><br><span class="line">	listen 80;</span><br><span class="line">	root /data/site/a.chen.com;</span><br><span class="line">	access_log /data/logs/nginx/a.chen.com-access.log main;</span><br><span class="line">    location /</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>b域名服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">	server_name b.chen.com;</span><br><span class="line">	listen 80;</span><br><span class="line">	root /data/site/b.chen.com;</span><br><span class="line">	access_log /data/logs/nginx/b.chen.com-access.log main;</span><br><span class="line">    location /</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>配置解析：</p>
<ul>
<li>server{}：配置虚拟主机必须有的的段</li>
<li><p>server_name:虚拟主机的域名，可以写多个域名，类似于别名，比如说你可以配置成：（这样的话，任何一个域名，内容都是一样的）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server_name a.chen.com b.chen.com c.chen.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>listen：127.0.0.1:80 监听端口</p>
</li>
<li>root ：站点根目录，网站文件存放的地方。（注：站点目录和域名尽量一样）</li>
<li>access_log：访问日志</li>
<li>location /{}：默认uri</li>
</ul>
<h3 id="3-检查nginx配置是否正确"><a href="#3-检查nginx配置是否正确" class="headerlink" title="3.检查nginx配置是否正确"></a>3.检查nginx配置是否正确</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -t</span><br></pre></td></tr></table></figure>
<ul>
<li>若出现以下两行ok和successful，表示配置没问题<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-重启nginx"><a href="#4-重启nginx" class="headerlink" title="4.重启nginx"></a>4.重启nginx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>
<ul>
<li>（注：若是之前没有启动过，则启动即可，但若启动过了，应该重启，不然会出现后面配置成功后但是访问域名却一直是nginx的欢迎界面）<h4 id="5-测试"><a href="#5-测试" class="headerlink" title="5.测试"></a>5.测试</h4><h4 id="5-1-Windows下测试"><a href="#5-1-Windows下测试" class="headerlink" title="5.1.Windows下测试"></a>5.1.Windows下测试</h4>修改hosts文件：C:\Windows\System32\drivers\etc，添加以下内容：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.111 a.chen.com</span><br><span class="line">192.168.1.111 b.chen.com</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-2-Linux下测试"><a href="#5-2-Linux下测试" class="headerlink" title="5.2.Linux下测试"></a>5.2.Linux下测试</h4><p>修改hosts文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;192.168.1.111 a.chen.com 192.168.1.111 b.chen.com&apos; &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure></p>
<h4 id="5-3-测试结果"><a href="#5-3-测试结果" class="headerlink" title="5.3.测试结果"></a>5.3.测试结果</h4><p>浏览器直接输入：a.chen.com 和 b.chen.com<br><img src="https://i.imgur.com/LTz299K.png" alt=""><br>Linux测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://a.chen.com</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgur.com/CvBAEYK.png" alt=""></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/08/27/nginx/Nginx配置多虚拟主机（即配置域名）/" data-id="cjfeor72a0016w5h2a4d7267g" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-nginx/Nginx root&amp;alias文件路径配置解析" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/08/26/nginx/Nginx root&alias文件路径配置解析/">Nginx root&amp;alias文件路径配置解析</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/08/26/nginx/Nginx root&alias文件路径配置解析/">
            <time datetime="2017-08-26T14:43:43.000Z" itemprop="datePublished">2017-08-26</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Nginx/">Nginx</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="Nginx-root-amp-alias文件路径配置解析"><a href="#Nginx-root-amp-alias文件路径配置解析" class="headerlink" title="Nginx root&amp;alias文件路径配置解析"></a>Nginx root&amp;alias文件路径配置解析</h1><ul>
<li>nginx在指定文件路径有两种方式root和alias，这两种的主要区别在于nginx如何解析location后面的uri，这会使两者分别以不同的方式请求映射到服务器的文件上。<h3 id="1-root语法的使用"><a href="#1-root语法的使用" class="headerlink" title="1.root语法的使用"></a>1.root语法的使用</h3>【root】<br>语法： root path<br>默认值： root html<br>配置段： http/server/location/if<br>例子:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location ^~/chen/ &#123;</span><br><span class="line">	root /data/www/www.chen.com;</span><br><span class="line">	autoindex on;</span><br><span class="line">	auto_basic &quot;Restricted&quot;;</span><br><span class="line">	auto_basic_user_file passwd/chen;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>例子解析：<br>&emsp;&emsp;如果请求的uri是/chen/httplogs/<a href="http://www.chen.com-access.log时，web服务器将会返回服务器上的“/data/www/www.chen.com”(root的path)+“/chen/httplogs/www.chen.com-access.log”的文件。也就是说root路径配置会根据完整的uri请求来映射，也就是/path/uri" target="_blank" rel="noopener">www.chen.com-access.log时，web服务器将会返回服务器上的“/data/www/www.chen.com”(root的path)+“/chen/httplogs/www.chen.com-access.log”的文件。也就是说root路径配置会根据完整的uri请求来映射，也就是/path/uri</a></p>
<h3 id="2-alias语法的使用"><a href="#2-alias语法的使用" class="headerlink" title="2.alias语法的使用"></a>2.alias语法的使用</h3><p>【alias】<br>语法：alias path<br>配置段：location<br>例子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location ^~ /binapp/ &#123;</span><br><span class="line">	limit_conn limit 4;</span><br><span class="line">	limit_rate 200k;</span><br><span class="line">	internal;</span><br><span class="line">	alias /data/statics/bin/apps/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>例子解析：<br>&emsp;&emsp;alias会把location后面配置的路径丢弃，把当前匹配到的目录指向到指定的目录。如果一个请求的uri是/binapp/a.chen.com/favicon时，web服务器将会返回服务器上的“/data/statics/bin/apps/”+“a.chen.com/favicon.html”的文件<br>&emsp;&emsp;alias使用总结：</p>
<ul>
<li>使用alias时，目录名后面一定要加“/“</li>
<li>alias可以指定任何名称</li>
<li>alias在使用正则表达式时，必须捕捉要匹配到的内容并在指定的内容处使用</li>
<li>alias只能位于location块中。</li>
</ul>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://catalpaflat.cn/2017/08/26/nginx/Nginx root&alias文件路径配置解析/" data-id="cjfeor72d001dw5h2na4jza8x" class="article-share-link"><i class="fa fa-share"></i>Bagikan</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Berikutnya &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">Terbaru</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/02/05/docker/命令/run/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/docker/">docker</a></p>
                            <p class="item-title"><a href="/2018/02/05/docker/命令/run/" class="title">Docker run 命令</a></p>
                            <p class="item-date"><time datetime="2018-02-05T14:33:12.000Z" itemprop="datePublished">2018-02-05</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/01/23/java/Java开发规范/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Java/">Java</a></p>
                            <p class="item-title"><a href="/2018/01/23/java/Java开发规范/" class="title">Java 编码规范</a></p>
                            <p class="item-date"><time datetime="2018-01-23T05:20:56.000Z" itemprop="datePublished">2018-01-23</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/01/05/docker/安装/docker安装/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/docker/">docker</a></p>
                            <p class="item-title"><a href="/2018/01/05/docker/安装/docker安装/" class="title">CentOS Docker 安装</a></p>
                            <p class="item-date"><time datetime="2018-01-05T08:33:56.000Z" itemprop="datePublished">2018-01-05</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/16/java/Java 实现中文-拼音转换/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Java/">Java</a></p>
                            <p class="item-title"><a href="/2017/12/16/java/Java 实现中文-拼音转换/" class="title">Java 实现中文-拼音转换</a></p>
                            <p class="item-date"><time datetime="2017-12-16T02:16:56.000Z" itemprop="datePublished">2017-12-16</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/17/Quartz/自定义Quartz超实用工具类/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Quartz/">Quartz</a></p>
                            <p class="item-title"><a href="/2017/11/17/Quartz/自定义Quartz超实用工具类/" class="title">自定义Quartz超实用工具类</a></p>
                            <p class="item-date"><time datetime="2017-11-17T03:09:37.000Z" itemprop="datePublished">2017-11-17</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">Kategori</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaEE/">JavaEE</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jenkins/">Jenkins</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Quartz/">Quartz</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/支付/">支付</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/服务器/">服务器</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/消息队列/">消息队列</a><span class="category-list-count">3</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">Arsip</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaEE/">JavaEE</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quartz/">Quartz</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/支付/">支付</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/支付宝支付/">支付宝支付</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息队列/">消息队列</a><span class="tag-list-count">3</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">awan tag</h3>
        <div class="widget tagcloud">
            <a href="/tags/Java/" style="font-size: 17.5px;">Java</a> <a href="/tags/JavaEE/" style="font-size: 15px;">JavaEE</a> <a href="/tags/Jenkins/" style="font-size: 12.5px;">Jenkins</a> <a href="/tags/Nginx/" style="font-size: 20px;">Nginx</a> <a href="/tags/Quartz/" style="font-size: 12.5px;">Quartz</a> <a href="/tags/docker/" style="font-size: 12.5px;">docker</a> <a href="/tags/支付/" style="font-size: 12.5px;">支付</a> <a href="/tags/支付宝支付/" style="font-size: 10px;">支付宝支付</a> <a href="/tags/服务器/" style="font-size: 12.5px;">服务器</a> <a href="/tags/消息队列/" style="font-size: 15px;">消息队列</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">tautan</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 CatalpaFlat<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>